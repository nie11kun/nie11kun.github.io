<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns="http://purl.org/rss/1.0/"
xmlns:dc="http://purl.org/dc/elements/1.1/">
<channel rdf:about="https://blog.niekun.net/feed/rss/category/Windows/">
<title>Marco Nie - Windows</title>
<link>https://blog.niekun.net/category/Windows/</link>
<description></description>
<items>
<rdf:Seq>
<rdf:li resource="https://blog.niekun.net/archives/2860.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2770.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2757.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2340.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2139.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2103.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2098.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2061.html"/>
<rdf:li resource="https://blog.niekun.net/archives/2021.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1911.html"/>
</rdf:Seq>
</items>
</channel>
<item rdf:about="https://blog.niekun.net/archives/2860.html">
<title>Windows 下虚拟机安装 MacOS</title>
<link>https://blog.niekun.net/archives/2860.html</link>
<dc:date>2023-11-03T09:08:00+08:00</dc:date>
<description>经过测试，我的电脑安装好后可以启动，但是每次输入管理员口令就会四国。可能和我的电脑 cpu 不能完美支持 macos 内核有关，下面介绍安装方法。工具：vmware workstationunlockermacos Monterey iso image环境准备首先需要主板支持虚拟化 VT，需要在 bios 中打开对应选项。注意此项必须配置，否则安装会不成功。VMware workstation 默认不支持安装 macos，需要使用第三方工具 unlocker 来开启支持，直接在上方提供的 github 主页下载最新版本即可，运行 windows 文件夹下的 unlock.exe 即可。然后下载 macos iso 镜像文件，在我上面提供的网站中下载即可。配置虚拟机按照正常的新建虚拟机的方式新建，添加下载好的系统镜像用来安装，配置好确认后先不要启动虚拟机，先修改对应虚拟机文件夹下的 vmx 文件。文本编辑器打开 vmx 文件后，在最后一行添加一句：smc.version = 0
保存后即可启动虚拟机，进入 recovery 工具后，先格式化硬盘，然后安装系统，提示一步步安装即可。参考链接How To Install macOS Monterey On Vmware On Windows PcWindows用VM虚拟机安装MacOS Ventura 13.6系统全流程教程</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2770.html">
<title>命令行激活 Windows 密钥</title>
<link>https://blog.niekun.net/archives/2770.html</link>
<dc:date>2022-09-19T09:22:00+08:00</dc:date>
<description>注意：安装新密钥及激活时需要在管理员权限下运行终端。安装新密钥，会自动替换当前密钥：slmgr /ipk xxxx-xxxx-xxxx-xxxx-xxxx
激活 Windows：slmgr /ato
显示当前授权信息：slmgr /dli
显示详细授权信息：slmgr /dlv
显示授权剩余日期：slmgr /xpr
密钥可用性在线检测：https://dbmer.com/checkkey/</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2757.html">
<title>Windows 配置 FTP 服务器</title>
<link>https://blog.niekun.net/archives/2757.html</link>
<dc:date>2022-09-15T15:04:00+08:00</dc:date>
<description>Windows 10 以上系统自带 FTP server，可以简单的搭建一个局域网内应用的 FTP 服务器。下面介绍具体操作流程。搜索 windows feature 打开功能开关配置界面：开启如下 ftp 相关选项，确认后等待安装完成：搜索 Administrative Tools：双击 Internet Information Services (IIS) Manager:sites 上右键点击 add ftp site：设置名称及共享路径：选择无 ssl：选择 basic 验证以及指定可登录 FTP 的用户，设置读写权限：可以单独建立一个用户用来登录 ftp，建立账户可以参考我的教程：https://blog.niekun.net/archives/2103.html#title-4设置完成后，点击完成即可。然后配置防火墙例外，搜索 allow an app through windows firewall:在列表中找到 ftp server 并打勾即可：以上就完成了 Windows 端 ftp 服务器的搭建，可以使用 ftp 客户端登录此 ftp 服务器了。参考链接：How to set up and manage an FTP server on Windows 10</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2340.html">
<title>解除 Windows 11 TPM 或 CPU 限制</title>
<link>https://blog.niekun.net/archives/2340.html</link>
<dc:date>2021-10-08T11:58:00+08:00</dc:date>
<description>最近微软发布了 Windows 11 正式版。但是对设备硬件有一些限制，可以通过修改注册表的方式解除限制。首先打开注册表，快捷键 win + R，输入 regedit：通过左侧层级菜单找到：Computer\HKEY_LOCAL_MACHINE\SYSTEM\Setup\MoSetup:选中 Mosetup，菜单栏选择 edit - New - DWORD 添加新键，重命名为：AllowUpgradesWithUnsupportedTPMOrCPU：双击此键设置值为 1，然后确认：然后就可以下载镜像安装了，期间会提示硬件不符合要求，但多了个接受选项安装 Windows 11：升级故障在实际升级中，我遇到了一个困扰几个星期的问题，当显示升级进度到 31% 的时候就停留不动了，尝试了无数次都无法解决。最后在今天翻看台湾 Windows 社群的时候找到了一篇帖子，受到启发才找到了问题点。一般这种问题都是因为当前系统内安装的某个硬件的驱动有问题导致升级无法进行，我们需要做的就是找到这个驱动是什么然后卸载它。我们需要从 C:\$WINDOWS.~BT\Sources\Panther 目录内的 CompatData_ 开头的 xml 文件中找到 DriverPackages 标签的内容，找到 BlockMigration="True" 后面的 inf="XXX.inf" 记住这里的 inf 文件名称，在 C:\Windows\INF 目录中找到对应的 inf 文件，用记事本打开文件，查看这到底是什么驱动，根据驱动名称和驱动版本等信息，在设备管理器中找到对应驱动并卸载它。如果 xml 文件中没有找到相关信息，则需要在 C:\$WINDOWS.~BT\Sources\Panther 目录内 setupact.log 文件中找相关信息，一般我们直接翻到日志最后一部分，查找相关信息，同样是找到 XXX.inf 文件。正确的找到并卸载驱动后，需要删除 C:\$WINDOWS.~BT\Sources\Panther 中的 compatscancache.dat 和 CompatData_ 开头的 xml 文件。然后就可以测试再次启动升级。参考链接windows 11更新卡在35%</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2139.html">
<title>Windows 主机使用 VMware 虚拟机在共享文件夹调试 node.js 时 npm install 报错问题的处理</title>
<link>https://blog.niekun.net/archives/2139.html</link>
<dc:date>2021-02-07T11:07:10+08:00</dc:date>
<description>由于 node.js 在 Windows 下会有各种问题，最好的开发环境还是 Linux，所以我通过 VMware 内安装 Ubuntu 虚拟机的方式学习 node.js。我的流程是：VMware 安装 Ubuntu共享 Windows 下的文件夹给 Ubuntu 作为开发目录Windows 下使用 vs code 通过 ssh 方式远程连接 Ubuntu通过远程连接的方式在 Windows 下做 node.js 开发实际体验很好。但是在通过 npm 安装某些包时常常会有报错出现，错误日志大概意思就是说无法给 node_modules 文件夹内安装的库文件添加软连接到系统路径。网上查询后发现了问题原因，我的开发目录实际是在 Windows 下的，Windows 和 Linux 有着不一样的文件系统和路径格式，所以 npm 在安装某些包含 bin 可执行文件的第三方库时，会默认自动创建相关文件的软链接到 Linux 系统路径，这样就就报错了。如果要坚持使用共享目录的形式做开发，那么需要设置在 npm 安装新库时使用参数 --no-bin-links 告诉系统不要自动创建软连接，语法如下：npm install cowsay --no-bin-links
这样就会跳过相关步骤。也可以设置到 npm 配置中，这样以后安装的包都会默认不创建 bin 的软连接了：npm config set bin-links false
当然最理想的方式就是将开发路径放置在 Linux 系统中，而不是通过共享目录的形式。这样就是一个纯原生的环境。参考链接：https://github.com/npm/npm/issues/2221</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2103.html">
<title>Windows 配置安全的 smb 共享</title>
<link>https://blog.niekun.net/archives/2103.html</link>
<dc:date>2021-02-03T10:28:00+08:00</dc:date>
<description>最近研究了下 Windows 的共享设置，目的是在同一局域网下共享文件夹给其他设备读写。下面从原理和实际操作上介绍下共享过程。SMBWindows 共享使用 Server Message Block (SMB) 协议，它可以让应用程序访问本机网络下的其他设备的文件及服务。SMB 是 IBM 在 1980 年代创造的协议，目前已经有了很多的升级及分支。SMB 协议允许应用程序访问远程主机的文件和资源如打印机等，也可以同远程主机上设置了接收 SMB 协议的应用程序通信。它运行在网络的 layer 7 层，也就是 application 应用层，使用 TCP/IP 的 445 端口传输数据。从 Windows 95 开始，微软将引入了 SMB 协议的支持。Linux 端，samba 作为一个开源软件提供 SMB 的支持。SMB 协议也是在不断发展的，下面是一个简单的版本更新过程：SMB 1.0 (1984): IBM 为 DOS 下的文件共享创造了 SMBCIFS (1996): 微软开发了 SMB 的分支版本并集成在 Windows 95，添加了大文件的支持，直接在 TCP/IP 传输SMB 2.0 (2006): 在 Windows Vista 和 Windows Server 2008 中发布. 提升了性能SMB 2.1 (2010): 在 Windows Server 2008 R2 和 Windows 7 中发布SMB 3.0 (2012): 在 Windows 8 和 Windows Server 2012 中发布. 提升了性能，增加备份，安全和管理功能SMB 3.02 (2014): 在 Windows 8.1 和 Windows Server 2012 R2 中发布. 提升性能并完全停止支持 CIFS/SMB 1.0SMB 3.1.1 (2015): 在 Windows 10 和 Windows Server 2016 中发布在 2017 年，利用 SMB 1.0 的漏洞，WannaCry 勒索软件在互联网中大规模传播，微软虽然立刻发布了补丁，但专家还是建议立刻停止运行 SMB 1.0 协议。下面介绍在 Windows 10 中配置共享文件夹。关闭 smb1.0由于 smb1.0 过于久远且不安全，所以我们最好将其关闭，默认情况下系统中他也是关闭的。系统搜索并打开 打开或关闭 Windows 功能 turn windows features on or off：在其中找到 smb1.0 并将其关闭，可能会提示需要重启系统：Windows 设置共享下面配置共享， 步骤如下：新建一个用户专门用于共享文件的授权，并合理设置此用户的权限；合理设置网络共享和系统安全的相关设置；开启共享，授权指定用户；创建专用用户搜索并打开计算机管理 computer management：找到本地用户和组，点击用户文件夹：右键点击 new user 创建新用户，设置用户名和密码，下面选中用户不可修改密码和密码永不过期：配置用户权限首先禁用启用不安全的来宾登录，win + r 搜索 gpedit.msc 本地组策略编辑器:如下路径找到选项：双击进入设置，关闭此选项并确认：然后 win + r 搜索 secpol.msc 打开本地安全策略，配置本地用户权限分配：首先配置可以从网络访问本机的用户：双击进入后点击 add user 添加我们刚刚创建的用户：在下方输入我们创建的用户名，然后点击右侧的 check names 自动匹配用户名：确认后再列表中就出现了对应用户，注意如果列表中有 everyone 等其他用户时，为了安全起见可以将它们从列表中删除。完成后点击 ok 确认修改。然后配置这个用户拒绝本地登录和拒绝远程桌面登录，因为我们创建这个用户只是为了 smb 共享登录使用。也是在本地用户权限分配页面找到对应选项并配置此用户到列表：开启有保护的共享首先打开控制面板，进入 network and Internet：点击 network and sharing center：点击 change advanced sharing settings：在 current profile 中打开网络发现和文件共享：然后在 all network 中打开密码保护：控制面板配置完成后，我们开始配置需要共享的文件夹。文件夹共享在需要共享的文件夹上点击右键，选择属性：在 share 选项卡中点击 advanced share：选中 share this folder：点击 permission：如果有先将 everyone 用户删掉，然后点击 add 添加 marco 用户，点击 check names 自动补全：然后配置用户权限，根据需要设置读写权限，这里直接选中 full control：然后还有一步很重要，设置 marco 用户对此共享文件夹具有访问权限，否则也会提示无法访问文件夹，点击 security：如果用户列表里没有 marco 用户，则需要添加进去，点击 edit 添加用户，方法和上面的方法类似，最后 marco 用户在列表里面即可，可以配置用户权限：点击 ok 保存设置。确认后共享文件夹就配置完成了。访问共享文件下面介绍在其他局域网设备访问主机的共享文件夹。Windows在 Windows 上，打开 file explorer，点击 network：在右侧就是本地网络下启用了网络发现的设备列表，点击进入设置了共享文件夹的设备名称，根据提示输入配置好的用户名和密码就可以访问了：也可以在地址栏直接输入共享路径地址，以双反斜线\\开头后面是设备 IP 或名称，如：\\DESKTOP-BS3C55D。关于设备的名称，可以在终端通过 whoami 命令查询：iPhone在支持 SMB 协议的设备或应用程序中都可以打开 Windows 共享的文件，下面介绍通过 iPhone 的 files app 来连接到 Windows 共享目录。打开 files app，点击右上角的 ... 选择 connect to server：在 server 中输入共享主机的地址，这里直接输入 IP 地址：输入用户名和密码，完成后就可以访问到共享目录了：如果文件夹设置的是可读写权限，就可以在手机上传输文件到共享目录了。参考链接：Server Message Block Protocol (SMB protocol)Windows 10/ 11 下安全并正确地使用 SMB 共享</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2098.html">
<title>解除 UWP 应用的网络隔离</title>
<link>https://blog.niekun.net/archives/2098.html</link>
<dc:date>2021-02-02T09:33:00+08:00</dc:date>
<description>Microsoft store 里都是 UWP 应用，运行在被称为 App Container 的虚拟沙箱环境中，其安全性及纯净度远胜于传统的 EXE 应用。但 App Container 机制同时也阻止了网络流量发送到本机（即 loopback）， 使大部分网络抓包调试工具无法对 UWP 应用进行流量分析。该机制也阻止了 UWP 应用访问 localhost，如果你的代理地址在本地地址，UWP 就无法访问。有两种方法来解除某个 UWP 应用的沙盒隔离，一种是使用系统自带的工具 CheckNetIsolation，一种是使用第三方工具 fiddler。CheckNetIsolationWindows 10 自带了一个 CheckNetIsolation 工具，可以解除 UWP 应用的网络隔离，使之可以正常访问本地地址在终端执行以下指令即可：CheckNetIsolation.exe loopbackexempt -a -p=SID
SID(security identifier) 是每个 UWP 应用独有的识别码，可以从注册表中获得应用的 SID 码。快捷键 win + R 打开运行窗口，输入 regedit 进入注册表。访问如下路径：\HKEY_CURRENT_USER\SOFTWARE\Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\AppContainer\Mappings\：此路径下的左侧文件夹名称就是当前安装的每个 UWP 应用的 SID 码，右侧的 DisplayName 就是应用的名称，可以用来帮助找到需要的应用 SID。复制需要解除隔离的应用的 SID 码执行上面的命令即可。然后应用就可以正常访问本地地址了，也可以使用抓包工具获取到流量。fiddler也可以使用第三方软件来实现以上任务，这里介绍 fiddler。fiddler 是一款免费的网络调试代理工具。官网地址：https://www.telerik.com/fiddler下载安装后打开应用，点击左上角的 WinConfig：会弹出所有 UWP 应用列表，找到需要解除隔离的应用，点击左侧的选择框，然后点击 save change 即可：此时再次运行对应的应用，就可以在 fiddler 看到应用的流量信息了。注意 fiddler 需要一直保持开启状态解除隔离才会生效。使用 fiddler 还可以方便的设置代理服务，使选中的应用通过代理访问网络，点击 tools - options：在弹出栏中，点击 gateway，选择 manual proxy configuration：第一行设置代理地址，模式为：proxyserver:8080
也可以根据网络协议设置：http=httpproxy:8080;https=httpsproxy:8080
第二行设置 bypass 忽略列表，可以设置忽略代理本地地址或其他需要排除的地址：&lt;local&gt;;*.extranet.example.com;
点击 ok 保存后即可，此时在 WinConfig 中选中的 UWP 应用就会通过代理地址访问网络。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2061.html">
<title>VMware 虚拟机 NAT 网络下配置端口转发到主机</title>
<link>https://blog.niekun.net/archives/2061.html</link>
<dc:date>2021-01-12T11:06:00+08:00</dc:date>
<description>今天安装了 Ubuntu 虚拟机用来做 node.js 开发，在选择网络模式时我选择了 NAT 模式，因为这样可以在主机处于不同网络环境下使虚拟机都有着同一个 IP 地址，方便管理。但是在此时中发现，虚拟机可以正常访问主机及外网，但是主机无法通过分配的 NAT 地址来 ssh 访问虚拟机。查询后发现这是正常现象。可以通过设置端口转发来将虚拟机端口映射到主机端口来实现对虚拟机的访问。首先给虚拟机设置一个静态 ip 地址：然后打开虚拟网络编辑器：选中 NAT 对应的网卡，这里是 vnet 8，点击 NAT 设置：在端口转发栏点击添加：设置要转发到的主机端口及对应虚拟机 IP 和端口等信息，这里我需要转发 ssh 的 22 端口到主机的 2222 端口：点击确定保存设置即可。设置好后就可以通过访问主机本地 2222 端口实现 ssh 访问虚拟机了。可以根据需要设置多个端口转发。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/2021.html">
<title>Windows 补丁下载</title>
<link>https://blog.niekun.net/archives/2021.html</link>
<dc:date>2020-12-22T10:54:50+08:00</dc:date>
<description>如果需要单独下载某个 Windows 补丁，可以在其官网下载：https://www.catalog.update.microsoft.com/搜索补丁编号即可。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1911.html">
<title>Speedtest CLI 命令行测速工具</title>
<link>https://blog.niekun.net/archives/1911.html</link>
<dc:date>2020-11-16T13:08:00+08:00</dc:date>
<description>speedtest 是国外很流行的测速平台，可以直接在其网站上测试本地上行下行带宽，最近看到其提供了本地命令行工具，使用起来更加方便了。官网：https://www.speedtest.net/安装首先需要到官网安装对应平台的 CLI 工具：https://www.speedtest.net/apps/cliLinux 类系统可以直接在使用 apt/brew 等包管理工具方便的安装，Windows 下需要手动下载 exe 可执行文件使用。macOS:brew tap teamookla/speedtest
brew update
brew install speedtest --forceubuntu:sudo apt-get install gnupg1 apt-transport-https dirmngr
export INSTALL_KEY=379CE192D401AB61
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys $INSTALL_KEY
echo &quot;deb https://ookla.bintray.com/debian generic main&quot; | sudo tee  /etc/apt/sources.list.d/speedtest.list
sudo apt-get update
sudo apt-get install speedtestwindows:首先在网站上下载可执行文件，点击下载 1.0.0 版。可执行文件为 speedtest.exe，需要将其目录加入系统 PATH 路径才可以直接在 terminal 调用，加入 PATH 方法参考我的教程：https://blog.niekun.net/archives/413.html使用在终端下使用 speedtest -h 命令查看帮助：Speedtest by Ookla is the official command line client for testing the speed and performance of your internet connection.

Version: speedtest 1.0.0.2

Usage: speedtest [&lt;options&gt;]
  -h, --help                        Print usage information
  -V, --version                     Print version number
  -L, --servers                     List nearest servers
  -s, --server-id=#                 Specify a server from the server list using its id
  -I, --interface=ARG               Attempt to bind to the specified interface when connecting to servers
  -i, --ip=ARG                      Attempt to bind to the specified IP address when connecting to servers
  -o, --host=ARG                    Specify a server, from the server list, using its host's fully qualified domain name
  -p, --progress=yes|no             Enable or disable progress bar (Note: only available for 'human-readable'
                                    or 'json' and defaults to yes when interactive)
  -P, --precision=#                 Number of decimals to use (0-8, default=2)
  -f, --format=ARG                  Output format (see below for valid formats)
  -u, --unit[=ARG]                  Output unit for displaying speeds (Note: this is only applicable
                                    for ‘human-readable’ output format and the default unit is Mbps)
  -a                                Shortcut for [-u auto-decimal-bits]
  -A                                Shortcut for [-u auto-decimal-bytes]
  -b                                Shortcut for [-u auto-binary-bits]
  -B                                Shortcut for [-u auto-binary-bytes]
      --selection-details           Show server selection details
      --ca-certificate=ARG          CA Certificate bundle path
  -v                                Logging verbosity. Specify multiple times for higher verbosity
      --output-header               Show output header for CSV and TSV formats

 Valid output formats: human-readable (default), csv, tsv, json, jsonl, json-pretty

 Machine readable formats (csv, tsv, json, jsonl, json-pretty) use bytes as the unit of measure with max precision

 Valid units for [-u] flag:
   Decimal prefix, bits per second:  bps, kbps, Mbps, Gbps
   Decimal prefix, bytes per second: B/s, kB/s, MB/s, GB/s
   Binary prefix, bits per second:   kibps, Mibps, Gibps
   Binary prefix, bytes per second:  kiB/s, MiB/s, GiB/s
   Auto-scaled prefix: auto-binary-bits, auto-binary-bytes, auto-decimal-bits, auto-decimal-bytes首先使用测试最近的测速节点 testspeed -L:root@Marco-vostro-14-wsl:~# speedtest -L
Closest servers:

    ID  Name                           Location             Country
==============================================================================
 29105  陕西移动5G                 Xi'an                China
  2461  China Unicom                   Chengdu              China
  4575  China Mobile Group Sichuan     Chengdu              China
 24337  China Mobile Group Sichuan Co.,Ltd. Chengdu              China
 35527  sccn                           Chengdu              China
 31985  China Unicom                   Chongqing            China
 17584  Chongqing Mobile Company       Chongqing            CN
  5530  CCN                            Chongqing            China
 16145  Lanzhou,China Mobile,Gansu     Lanzhou              China执行 speedtest 命令进行测速，默认使用上面测试的最近的节点：root@Marco-vostro-14-wsl:~# speedtest

   Speedtest by Ookla

     Server: Chongqing Mobile Company - Chongqing (id = 17584)
        ISP: China Telecom
    Latency:    31.45 ms   (25.47 ms jitter)
   Download:    14.31 Mbps (data used: 17.5 MB)
     Upload:     8.23 Mbps (data used: 11.3 MB)
Packet Loss:     0.0%
 Result URL: https://www.speedtest.net/result/c/bee17d45-7b9c-44e6-8a6e-ef99d84ba441以上就是简单的用法，可以查看帮助了解更多的使用方法。</description>
</item>
</rdf:RDF>