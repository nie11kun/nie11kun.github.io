<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"
xmlns:thr="http://purl.org/syndication/thread/1.0"
xml:lang="zh-CN"
xml:base="https://blog.niekun.net/tag/nginx/"
>
<title type="text">Marco Nie - nginx</title>
<subtitle type="text"></subtitle>
<updated>2019-12-09T16:21:00+08:00</updated>
<generator uri="http://typecho.org/" version="1.2/18.10.23">Typecho</generator>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/tag/nginx/" />
<id>https://blog.niekun.net/feed/atom/tag/nginx/</id>
<link rel="self" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/tag/nginx/" />
<entry>
<title type="html"><![CDATA[限制用户名密码访问页面 in nginx]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/730.html" />
<id>https://blog.niekun.net/archives/730.html</id>
<updated>2019-12-09T16:21:00+08:00</updated>
<published>2019-12-09T16:21:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[有时候我们想要限制某个页面的访问权限，需要用户名密码才能进入。如果使用 nginx 作为反向代理服务器，可以使用 auth_basic 来实现页面加密。环境需求：Linux envnginxap...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/730.html" xml:lang="zh-CN"><![CDATA[
<p>有时候我们想要限制某个页面的访问权限，需要用户名密码才能进入。</p><p>如果使用 <strong>nginx</strong> 作为反向代理服务器，可以使用 <strong>auth_basic</strong> 来实现页面加密。</p><p><strong>环境需求：</strong></p><p>Linux env<br>nginx<br><strong>apache2-utils</strong> (Debian, Ubuntu) or <strong>httpd-tools</strong> (RHEL/CentOS/Oracle Linux)</p><p><strong>安装环境：</strong></p><p>nginx 安装参考：<a href="https://niekun.net/index.php/archives/30.html">https://niekun.net/index.php/archives/30.html</a></p><p>安装 apache2-utils：</p><pre><code>apt-get install apache2-utils
</code></pre><p><strong>创建账户密码：</strong></p><p>使用了 htpasswd 命令创建用户。</p><p>关于 htpasswd 的详细使用：<a href="https://httpd.apache.org/docs/2.4/programs/htpasswd.html">https://httpd.apache.org/docs/2.4/programs/htpasswd.html</a></p><p>建议将账户信息文件建立在 nginx 目录，我放在 /etc/nginx/users 目录下：</p><pre><code>htpasswd -c /etc/nginx/users/.adminpasswd user1
</code></pre><p>.adminpasswd 为隐藏的存储所有账户信息的文件，user1 为用户名，回车后会提示输入密码，然后确认密码。</p><p>建立其他账户：</p><pre><code>htpasswd /etc/nginx/users/.adminpasswd user2
</code></pre><p>不需要 <code>-c</code> 参数，因为文件已经建立了。</p><p>验证账户密码 <code>-v</code>：</p><pre><code>htpasswd -v /etc/nginx/users/.adminpasswd user1
</code></pre><p>删除账户 <code>-D</code>：</p><pre><code>htpasswd -D /etc/nginx/users/.adminpasswd user1
</code></pre><p><strong>使用账户：</strong></p><p>打开 nginx 配置文件，在需要账户登录的路径段修改如下：</p><pre><code>location /path {
    ...
    auth_basic           &quot;Administrator's Area&quot;;
    auth_basic_user_file /etc/nginx/users/.adminpasswd;
    ...
    ...
}</code></pre><p>重新加载配置文件：</p><pre><code>service nginx configtest
service nginx reload
</code></pre><p>打开对应页面测试是否提示输入账号密码。</p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/730.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/730.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[fancyindex 插件模块美化 nginx 的默认 index 页面]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/725.html" />
<id>https://blog.niekun.net/archives/725.html</id>
<updated>2019-12-09T15:14:00+08:00</updated>
<published>2019-12-09T15:14:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[使用 nginx 的 autoindex 模块可以搭建简单的文件分享页面，但默认的页面比较简陋：autoindex 搭建教程参考：https://niekun.net/index.php/arc...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/725.html" xml:lang="zh-CN"><![CDATA[
<p><img src="https://niekun.net/usr/uploads/2019/12/4133735129.png" alt="2019-12-09T06:50:25.png" title="2019-12-09T06:50:25.png"></p><p>使用 <strong>nginx</strong> 的 <strong>autoindex</strong> 模块可以搭建简单的文件分享页面，但默认的页面比较简陋：<br><img src="https://niekun.net/usr/uploads/2019/12/3380876021.png" alt="2019-12-09T06:48:13.png" title="2019-12-09T06:48:13.png"></p><p><strong>autoindex</strong> 搭建教程参考：<a href="https://niekun.net/index.php/archives/26.html">https://niekun.net/index.php/archives/26.html</a></p><p>如果需要更加美观和丰富的页面，可以使用第三方模块 <strong>fancyindex</strong> 来实现。</p><p class="more"><a href="https://blog.niekun.net/archives/725.html" title="fancyindex 插件模块美化 nginx 的默认 index 页面">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/725.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/725.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[NGINX Rewrite 规则的应用]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/195.html" />
<id>https://blog.niekun.net/archives/195.html</id>
<updated>2019-04-04T22:44:00+08:00</updated>
<published>2019-04-04T22:44:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[参考文章：https://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewritehttps://www.nginx.com/blo...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/195.html" xml:lang="zh-CN"><![CDATA[
<p><strong>参考文章：</strong><br><a href="https://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite">https://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite</a><br><a href="https://www.nginx.com/blog/creating-nginx-rewrite-rules/">https://www.nginx.com/blog/creating-nginx-rewrite-rules/</a></p><p>rewrite 规则主要应用于修改客户端发起的 url 请求，主要使用场景有两个：<br>1.客户端请求的域名已经已经有了新的地址，需要自动将连接进行转换<br>2.需要根据请求的 url 动态处理到不同的页面，此处主要使用 try_files 指令</p><p class="more"><a href="https://blog.niekun.net/archives/195.html" title="NGINX Rewrite 规则的应用">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/195.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/195.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[使用Nginx配置强ssl的网站]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/187.html" />
<id>https://blog.niekun.net/archives/187.html</id>
<updated>2019-04-03T23:24:00+08:00</updated>
<published>2019-04-03T23:24:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[本文主要参考的网站：https://cipherli.sthttps://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.htmlThis...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/187.html" xml:lang="zh-CN"><![CDATA[
<p><strong>本文主要参考的网站：</strong><br><a href="https://cipherli.st">https://cipherli.st</a><br><a href="https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html">https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html</a></p><blockquote>This tutorial shows you how to set up strong SSL security on the nginx webserver. We do this by updating OpenSSL to the latest version to mitigate attacks like Heartbleed, disabling SSL Compression and EXPORT ciphers to mitigate attacks like FREAK, CRIME and LogJAM, disabling SSLv3 and below because of vulnerabilities in the protocol and we will set up a strong ciphersuite that enables Forward Secrecy when possible. We also enable HSTS and HPKP. This way we have a strong and future proof ssl configuration and we get an A+ on the Qually Labs SSL Test.</blockquote><p class="more"><a href="https://blog.niekun.net/archives/187.html" title="使用Nginx配置强ssl的网站">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/187.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/187.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[nginx实现mp4流媒体播放]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/177.html" />
<id>https://blog.niekun.net/archives/177.html</id>
<updated>2019-03-31T19:14:00+08:00</updated>
<published>2019-03-31T19:14:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[如果还没有安装nginx，参考教程：https://niekun.net/index.php/archives/30.html此功能使用的是 Nginx 的 ngx_http_mp4_modul...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/177.html" xml:lang="zh-CN"><![CDATA[
<p>如果还没有安装nginx，参考教程：<a href="https://niekun.net/index.php/archives/30.html">https://niekun.net/index.php/archives/30.html</a></p><p><strong>此功能使用的是 Nginx 的 ngx_http_mp4_module 模块。</strong></p><p>首先查看当前 nginx 是否已经安装了 ngx_http_mp4_module 模块：</p><pre><code>nginx -v
</code></pre><p>查看是否已经有了对应模块，一般使用 apt 安装的都集成了此模块。</p><p class="more"><a href="https://blog.niekun.net/archives/177.html" title="nginx实现mp4流媒体播放">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/177.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/177.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[重定向 HTTP to HTTPS in Nginx]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/118.html" />
<id>https://blog.niekun.net/archives/118.html</id>
<updated>2019-02-26T21:21:00+08:00</updated>
<published>2019-02-26T21:21:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[将http请求重定向为https，使所有连接都使用安全的ssl。重定向所有http请求以下配置为将所有收到的80端口的请求都重定向到443端口,这会把此ip下的所有域名都转换：server { ...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/118.html" xml:lang="zh-CN"><![CDATA[
<p>将http请求重定向为https，使所有连接都使用安全的ssl。</p><h2>重定向所有http请求</h2><p>以下配置为将所有收到的80端口的请求都重定向到443端口,这会把此ip下的所有域名都转换：</p><pre><code>server {
    listen           80;
    listen           [::]:80;
    server_name      _;
    return           301 https://$host$request_uri;
}</code></pre><p>listen 80 default_server 表示这是唯一监听80端口的server块<br>server_name _ 表示监听所有使用的域名</p><h2>重定向特定域名</h2><p>以下配置为重定向特定域名的请求，此方式适用于此ip下绑定多个域名的情况：</p><pre><code>server {
    listen           80;
    listen           [::]:80;
    server_name      your.domain;
    return           301 https://your.domain$request_uri;
}</code></pre><h2>443 server block</h2><p>设定我们的域名只接收443端口的访问：</p><pre><code>server {
    listen                443 ssl default_server;
    listen                [::]:443 ssl;
    server_name           foo.com;
}

server {
    listen                443 ssl;
    listen                [::]:443 ssl;
    server_name           bar.com;
}

...
</code></pre><p>只能设置一个域名为default_server。</p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/118.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/118.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[使用acme.sh生成 ssl 证书并部署到 Nginx]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/34.html" />
<id>https://blog.niekun.net/archives/34.html</id>
<updated>2019-02-19T09:02:00+08:00</updated>
<published>2019-02-19T09:02:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[acme.sh 实现了 acme 协议, 可以从 letsencrypt 生成免费的证书.官方说明：https://github.com/Neilpang/acme.sh安装acme.sh安装很...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/34.html" xml:lang="zh-CN"><![CDATA[
<p>acme.sh 实现了 <code>acme</code> 协议, 可以从 letsencrypt 生成免费的证书.</p><p>官方说明：<a href="https://github.com/Neilpang/acme.sh">https://github.com/Neilpang/acme.sh</a></p><h2>安装acme.sh</h2><p>安装很简单:</p><pre><code>apt-get install curl
curl  https://get.acme.sh | sh
</code></pre><p>安装过程进行了以下几步:</p><ul><li>把 acme.sh 安装到你的 root 目录下: <code>/root/.acme.sh/</code></li><li>自动为你创建 cronjob, 每天 0:00 点自动检测所有的证书, 如果快过期了, 需要更新, 则会自动更新证书.</li><li>在 /root/.bashrc 创建 一个 bash 的 alias: <code>alias acme.sh=&quot;/root/.acme.sh/acme.sh&quot;</code></li></ul><p>cronjob 的任务可以使用命令 <code>crontab -e</code> 查看。</p><p class="more"><a href="https://blog.niekun.net/archives/34.html" title="使用acme.sh生成 ssl 证书并部署到 Nginx">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/34.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/34.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Nginx 安装/编译教程]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/30.html" />
<id>https://blog.niekun.net/archives/30.html</id>
<updated>2019-02-18T16:57:00+08:00</updated>
<published>2019-02-18T16:57:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[我的VPS上的Nginx记得还是一年前安装的，一直没有升级，最近发现版本都到了1.14了，我的还是1.4，就想做一次升级。由于使用Nginx用到一些配置文件，所以我预计升级会导致配置文件恢复到默...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/30.html" xml:lang="zh-CN"><![CDATA[
<p>我的VPS上的<code>Nginx</code>记得还是一年前安装的，一直没有升级，最近发现版本都到了1.14了，我的还是1.4，就想做一次升级。</p><p>由于使用<code>Nginx</code>用到一些配置文件，所以我预计升级会导致配置文件恢复到默认，所以查询了一些资料后，安全的做了升级。</p><p class="more"><a href="https://blog.niekun.net/archives/30.html" title="Nginx 安装/编译教程">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/30.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/30.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[使用Nginx搭建HTTP共享文件夹]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/26.html" />
<id>https://blog.niekun.net/archives/26.html</id>
<updated>2019-02-18T15:14:00+08:00</updated>
<published>2019-02-18T15:14:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[最近有需求做一个类似网盘的功能，方便共享文件给他人，实际上就是把服务器的一个目录设置为可见。发现Nginx支持这一功能。官方相关文档：http://nginx.org/en/docs/http/...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/26.html" xml:lang="zh-CN"><![CDATA[
<p>最近有需求做一个类似网盘的功能，方便共享文件给他人，实际上就是把服务器的一个目录设置为可见。发现Nginx支持这一功能。</p><p>官方相关文档：<a href="http://nginx.org/en/docs/http/ngx_http_autoindex_module.html">http://nginx.org/en/docs/http/ngx_http_autoindex_module.html</a></p><p>在service里的新建需要共享目录的location段修改如下：</p><pre><code>location /downloads {
    root /home;
    autoindex on;
    autoindex_exact_size on;
    autoindex_localtime on;
}
</code></pre><p>后三句为打开当前location段的目录索引功能，显示文件大小，显示文件创建日期，建议只对需要共享的目录打开目录功能。</p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/26.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/26.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Nginx配置重定向到其他网页或端口]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/3.html" />
<id>https://blog.niekun.net/archives/3.html</id>
<updated>2019-02-15T14:32:00+08:00</updated>
<published>2019-02-15T14:32:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[打开nginx配置文件nginx.conf默认路径为：/etc/nginx/nginx.conf可以使用find指令找到这个文件：find / -name nginx.conf重定向到外部网站s...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/3.html" xml:lang="zh-CN"><![CDATA[
<p>打开nginx配置文件nginx.conf<br>默认路径为：<em>/etc/nginx/nginx.conf</em></p><p>可以使用find指令找到这个文件：<code>find / -name nginx.conf</code></p><p><strong>重定向到外部网站server内加入如下片段：</strong></p><pre><code>location /you/path {
    return 301 https://example.com;
}</code></pre><p><strong>重定向到内部其他端口server内加入如下片段：</strong></p><pre><code>location /ray {
    proxy_redirect off;
    proxy_pass http://127.0.0.1:10000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection &quot;upgrade&quot;;
    proxy_set_header Host $http_host;
}</code></pre><p>修改好后重启nginx：<code>service nginx restart</code></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/3.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/3.html" thr:count="0"/>
</entry>
</feed>