<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"
xmlns:thr="http://purl.org/syndication/thread/1.0"
xml:lang="zh-CN"
xml:base="https://blog.niekun.net/tag/mtime/"
>
<title type="text">Marco Nie - mtime</title>
<subtitle type="text"></subtitle>
<updated>2019-12-20T10:15:00+08:00</updated>
<generator uri="http://typecho.org/" version="1.2.0">Typecho</generator>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/tag/mtime/" />
<id>https://blog.niekun.net/feed/atom/tag/mtime/</id>
<link rel="self" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/tag/mtime/" />
<entry>
<title type="html"><![CDATA[Linux 自动删除指定天数前文件]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/832.html" />
<id>https://blog.niekun.net/archives/832.html</id>
<updated>2019-12-20T10:15:00+08:00</updated>
<published>2019-12-20T10:15:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<content type="html" xml:base="https://blog.niekun.net/archives/832.html" xml:lang="zh-CN"><![CDATA[
<div id="md_content_1" class="md_content" style="min-height: 50px;"><textarea id="append-test" style="display:none;">服务器上搭建了个云盘，有个 temp 目录存放一些临时文件，想要设定指定天数后自动删除，可以使用 Linux 脚本实现。

用到的命令：
find mtime crontab

基本思路是使用 find 命令筛选符合条件的文件或文件夹，使用 crontab 创建定时任务。

find 的详细用法：https://niekun.net/index.php/archives/543.html
crontab 的详细用法：https://niekun.net/index.php/archives/461.html


<!--more-->

指定删除 /temp 目录下超过 3 天的文件，新建脚本 timerRemove.sh 内容如下：
```
LOCALDIR="/temp/"
LOCALAGE="3"
cd ${LOCALDIR} || exit

find ${LOCALDIR}* -mtime +${LOCALAGE} -exec rm -rf {} \;
```

在 crontab 配置文件内修改如下，每 2 小时执行一次脚本：
```
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
HOME=/root

0  */2  *  *  * root bash /path/to/timerRemove.sh
```</textarea></div>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/832.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/tag/mtime/" thr:count="0"/>
</entry>
</feed>