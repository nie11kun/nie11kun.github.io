<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"
xmlns:thr="http://purl.org/syndication/thread/1.0"
xml:lang="zh-CN"
xml:base="https://blog.niekun.net/category/Linux/"
>
<title type="text">Marco Nie - Linux</title>
<subtitle type="text"></subtitle>
<updated>2020-03-30T11:05:00+08:00</updated>
<generator uri="http://typecho.org/" version="1.2/18.10.23">Typecho</generator>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/category/Linux/" />
<id>https://blog.niekun.net/feed/atom/category/Linux/</id>
<link rel="self" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Linux/" />
<entry>
<title type="html"><![CDATA[NGINX Reverse Proxy 反向代理的使用]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1378.html" />
<id>https://blog.niekun.net/archives/1378.html</id>
<updated>2020-03-30T11:05:00+08:00</updated>
<published>2020-03-30T11:05:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[Proxying is typically used to distribute the load among several servers, seamlessly show content ...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1378.html" xml:lang="zh-CN"><![CDATA[
<blockquote>Proxying is typically used to distribute the load among several servers, seamlessly show content from different websites, or pass requests for processing to application servers over protocols other than HTTP.</blockquote><p>nginx 可以将一个客户端的请求反向代理到其他地址/端口，从客户端上看不到代理过程。方向代理的常用来处理服务器上部署的多个网络服务，根据请求呈现不同网页内容，转发请求到其他应用程序等。支持转发的协议有： <strong> HTTP，FastCGI, uwsgi, SCGI, and memcached。</strong></p><p>不同于 nginx 的重定向 return/rewrite/try_fiels 功能，反向代理对于客户端是不可见的，关于重定向的语法参考：<a href="https://blog.niekun.net/archives/195.html">https://blog.niekun.net/archives/195.html</a></p><p>下面介绍 ngx_http_proxy_module 模块的使用方式。</p><p class="more"><a href="https://blog.niekun.net/archives/1378.html" title="NGINX Reverse Proxy 反向代理的使用">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1378.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1378.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[traceroute 路由 IP 查看]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1376.html" />
<id>https://blog.niekun.net/archives/1376.html</id>
<updated>2020-03-20T09:00:07+08:00</updated>
<published>2020-03-20T09:00:07+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[traceroute 是一种电脑网络工具。它可显示数据包在 IP 网络经过的路由器的 IP 地址。程序是利用增加存活时间（TTL）值来实现其功能的。每当数据包经过一个路由器，其存活时间就会减 1...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1376.html" xml:lang="zh-CN"><![CDATA[
<p>traceroute 是一种电脑网络工具。它可显示数据包在 IP 网络经过的路由器的 IP 地址。</p><p>程序是利用增加存活时间（TTL）值来实现其功能的。每当数据包经过一个路由器，其存活时间就会减 1。当其存活时间是 0 时，主机便取消数据包，并发送一个ICMP TTL数据包给原数据包的发出者。</p><p>traceroute 使用<strong>互联网控制信息协议(ICMP)</strong>实现，ICMP 依靠IP来完成它的任务，它是IP的主要部分。它与传输协议（如TCP和UDP）显著不同：它一般不用于在两点间传输数据。由于协议不同所以本地 http 代理对 traceroute 无效。</p><p>现代 Linux 系统称为 <strong>tracepath</strong>，Windows 系统称为 <strong>tracert</strong>，Windows NT 系统有结合 ping 和 traceroute 的 <strong>pathping</strong> 工具。</p><p class="more"><a href="https://blog.niekun.net/archives/1376.html" title="traceroute 路由 IP 查看">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1376.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1376.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[wkhtmltopdf 将 html为 pdf]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1375.html" />
<id>https://blog.niekun.net/archives/1375.html</id>
<updated>2020-03-18T12:58:56+08:00</updated>
<published>2020-03-18T12:58:56+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[一般浏览器都可以将当前页面输出为 pdf，但当有很多个 html 文件时一个一个转换就很麻烦了，可以使用 wkhtmltopdf 命令行工具来实现自动化批量转换。wkhtmltopdf and ...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1375.html" xml:lang="zh-CN"><![CDATA[
<p>一般浏览器都可以将当前页面输出为 pdf，但当有很多个 html 文件时一个一个转换就很麻烦了，可以使用 wkhtmltopdf 命令行工具来实现自动化批量转换。</p><blockquote>wkhtmltopdf and wkhtmltoimage are open source (LGPLv3) command line tools to render HTML into PDF and various image formats using the Qt WebKit rendering engine. These run entirely "headless" and do not require a display or display service.</blockquote><p>wkhtmltopdf 官网：<a href="https://wkhtmltopdf.org/">https://wkhtmltopdf.org/</a><br>GitHub 主页：<a href="https://github.com/wkhtmltopdf/wkhtmltopdf">https://github.com/wkhtmltopdf/wkhtmltopdf</a></p><p class="more"><a href="https://blog.niekun.net/archives/1375.html" title="wkhtmltopdf 将 html为 pdf">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1375.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1375.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[systemd 使用入门]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1334.html" />
<id>https://blog.niekun.net/archives/1334.html</id>
<updated>2020-03-13T15:27:34+08:00</updated>
<published>2020-03-13T15:27:34+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.htmlhttp://www.ruanyifeng.com/bl...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1334.html" xml:lang="zh-CN"><![CDATA[
<p><a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html">http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html</a><br><a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html">http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1334.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1334.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 下 VMware 安装 Ubuntu 虚拟机]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1316.html" />
<id>https://blog.niekun.net/archives/1316.html</id>
<updated>2020-03-13T14:00:00+08:00</updated>
<published>2020-03-13T14:00:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[虽然 Windows 10 自带有 WSL，可以安装 Linux 系统，但是在实际使用中发现还是有很多限制的。所以想要完整的 Linux 系统，还是安装了虚拟机。WSL 开启参考：https:/...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1316.html" xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/03/4046207363.png" alt="2020-03-13T03:42:47.png" title="2020-03-13T03:42:47.png"><br>虽然 Windows 10 自带有 WSL，可以安装 Linux 系统，但是在实际使用中发现还是有很多限制的。所以想要完整的 Linux 系统，还是安装了虚拟机。</p><p>WSL 开启参考：<a href="https://blog.niekun.net/archives/1148.html">https://blog.niekun.net/archives/1148.html</a></p><p>我使用的是 VMware workstation 安装了 Ubuntu 18.04 LTS。安装过程中与遇到了一些问题，需要特别的进行处理，在此做一下记录。</p><p class="more"><a href="https://blog.niekun.net/archives/1316.html" title="Windows 下 VMware 安装 Ubuntu 虚拟机">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1316.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1316.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[获取用户真实 IP in Nginx]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1296.html" />
<id>https://blog.niekun.net/archives/1296.html</id>
<updated>2020-03-06T15:00:00+08:00</updated>
<published>2020-03-06T15:00:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[对于没有连代理访问网站的用户或者没有加 CDN 的网站，可以直接在 Nginx 中用 deny 命令来拒绝某个 IP 的访问，$remote_addr 存储了当前链接用户的 IP:https:/...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1296.html" xml:lang="zh-CN"><![CDATA[
<p>对于没有连代理访问网站的用户或者没有加 CDN 的网站，可以直接在 Nginx 中用 deny 命令来拒绝某个 IP 的访问，<strong>$remote_addr</strong> 存储了当前链接用户的 IP:<a href="https://nginx.org/en/docs/http/ngx_http_access_module.html#deny">https://nginx.org/en/docs/http/ngx_http_access_module.html#deny</a></p><pre><code>location / {
    deny  192.168.1.1;
    allow 192.168.1.0/24;
    allow 10.1.1.0/16;
    allow 2001:0db8::/32;
    deny  all;
}</code></pre><p>如果加了代理或者 CDN 就没法直接获取到用户真实 IP 了，可以在 nginx 使用以下 map 指令提取用户真实 IP，注意 map 指令要写在配置文件的 http 段：</p><pre><code>#获取用户真实IP，并赋值给变量$clientRealIP
map $http_x_forwarded_for  $clientRealIp {
    default    $remote_addr;
    ~^([0-9\.]+),?.*$  $1;
}</code></pre><p>$clientRealIp 变量就是真是客户端的 IP 地址。</p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1296.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1296.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Nginx upstream timed out 问题的处理]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1280.html" />
<id>https://blog.niekun.net/archives/1280.html</id>
<updated>2020-03-05T08:53:00+08:00</updated>
<published>2020-03-05T08:53:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[在安装 wordpress 后遇到一个问题，打开后台的 theme 页面后，一直无法加载出来内容，查看后台 nginx 的日志，发现如下错误：[error] 10929#10929: *337 ...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1280.html" xml:lang="zh-CN"><![CDATA[
<p>在安装 wordpress 后遇到一个问题，打开后台的 theme 页面后，一直无法加载出来内容，查看后台 nginx 的日志，发现如下错误：</p><pre><code>[error] 10929#10929: *337 upstream timed out (110: Connection timed out) while reading upstream, client: 127.0.0.1, server: 127.0.0.1, request: &quot;GET /wp-admin/theme-install.php HTTP/1.1&quot;, upstream: &quot;fastcgi://unix:/run/php/php7.3-fpm.sock:&quot;, host: &quot;127.0.0.1&quot;, referrer: &quot;http://127.0.0.1/wp-admin/themes.php&quot;</code></pre><p>大概是处理 php 页面的时候 timeout 了，Google 了发现问题出在转发到代理服务器 fastCGI 时超时了:<a href="https://talk.plesk.com/threads/upstream-timed-out-110-connection-timed-out-randomly.350497/">https://talk.plesk.com/threads/upstream-timed-out-110-connection-timed-out-randomly.350497/</a><br>解决方案就是在 nginx 配置文件内定义一下相关超时时间设定：</p><pre><code>proxy_connect_timeout 600;
proxy_send_timeout 600;
proxy_read_timeout 600;
send_timeout 600;</code></pre><p>将上述内容加入 config 文件，reload nginx 测试页面加载是否正常：</p><pre><code>sudo service nginx configtest
sudo service nginx reload


</code></pre>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1280.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1280.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 10 WSL 不支持 systemd]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1258.html" />
<id>https://blog.niekun.net/archives/1258.html</id>
<updated>2020-03-04T11:44:25+08:00</updated>
<published>2020-03-04T11:44:25+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[在使用 WSL 中发现无法使用 systemd 指令，会有如下报错信息：System has not been booted with systemd as init system (PID 1...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1258.html" xml:lang="zh-CN"><![CDATA[
<p>在使用 WSL 中发现无法使用 systemd 指令，会有如下报错信息：System has not been booted with systemd as init system (PID 1). Can't operate</p><p>查询后发现 WSL 的确有这个问题：<a href="https://github.com/MicrosoftDocs/WSL/issues/457">https://github.com/MicrosoftDocs/WSL/issues/457</a></p><p>解决方法是用<strong>管理员权限打开 WSL</strong>，然后使用 <code>sudo service</code> 来控制进程，如：</p><pre><code>sudo service nginx start
</code></pre>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1258.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1258.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Nginx 可用指令和变量索引]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1257.html" />
<id>https://blog.niekun.net/archives/1257.html</id>
<updated>2020-03-04T11:19:18+08:00</updated>
<published>2020-03-04T11:19:18+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[手册：http://nginx.org/en/docs/涵盖了安装教程，开始使用教程，常用使用情景教程，指令索引，变量索引 等链接。变量：http://nginx.org/en/docs/var...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1257.html" xml:lang="zh-CN"><![CDATA[
<p>手册：<a href="http://nginx.org/en/docs/">http://nginx.org/en/docs/</a></p><blockquote>涵盖了<strong>安装教程，开始使用教程，常用使用情景教程，指令索引，变量索引</strong> 等链接。</blockquote><p>变量：<a href="http://nginx.org/en/docs/varindex.html">http://nginx.org/en/docs/varindex.html</a></p><blockquote>变量在 nginx 配置中使用很多，使用变量可以根据需要处理特定部分。如：$rui, $scheme, $request_filename, $host, $request_uri</blockquote><p>指令：<a href="http://nginx.org/en/docs/dirindex.html">http://nginx.org/en/docs/dirindex.html</a></p><blockquote>如：listen, include, location, if, auth_basic</blockquote>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1257.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1257.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Typecho 配合 Nginx 设置伪静态链接]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/1243.html" />
<id>https://blog.niekun.net/archives/1243.html</id>
<updated>2020-03-03T21:57:00+08:00</updated>
<published>2020-03-03T21:57:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<summary type="html"><![CDATA[由于 typecho 是一个动态网页，每篇文章都 URL 都是形如：https://niekun.net/index.php/archives/192.html这种包含 php 的动态网站首先不...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/1243.html" xml:lang="zh-CN"><![CDATA[
<p>由于 typecho 是一个动态网页，每篇文章都 URL 都是形如：<a href="https://niekun.net/index.php/archives/192.html">https://niekun.net/index.php/archives/192.html</a></p><p>这种包含 php 的动态网站首先不太美观链接比较长，而且在搜索引擎索引时也对动态链接不太友好。所以需要将以上链接形式进行处理，使网页看起来更像静态链接，形如：<a href="https://niekun.net/archives/192.html">https://niekun.net/archives/192.html</a>。</p><p class="more"><a href="https://blog.niekun.net/archives/1243.html" title="Typecho 配合 Nginx 设置伪静态链接">[...]</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/1243.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/archives/1243.html" thr:count="0"/>
</entry>
</feed>