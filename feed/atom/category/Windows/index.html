<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"
xmlns:thr="http://purl.org/syndication/thread/1.0"
xml:lang="zh-CN"
xml:base="https://blog.niekun.net/category/Windows/"
>
<title type="text">Marco Nie - Windows</title>
<subtitle type="text"></subtitle>
<updated>2024-08-10T11:06:00+08:00</updated>
<generator uri="https://typecho.org/" version="1.3.0">Typecho</generator>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/category/Windows/" />
<id>https://blog.niekun.net/feed/atom/category/Windows/</id>
<link rel="self" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/" />
<entry>
<title type="html"><![CDATA[将路径加入系统 path]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/path.html" />
<id>https://blog.niekun.net/archives/path.html</id>
<updated>2024-08-10T11:06:00+08:00</updated>
<published>2024-08-10T11:06:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<category scheme="https://blog.niekun.net/category/macos/" term="macOS" />
<summary type="html"><![CDATA[将路径加入系统 path 可以方便的在终端调用目录中的可执行文件或脚本。windows 和 macOS 设置方法不同，下面分别介绍。windows参考之前的文章：https://blog.nie...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/path.html" xml:lang="zh-CN"><![CDATA[
<p>将路径加入系统 path 可以方便的在终端调用目录中的可执行文件或脚本。windows 和 macOS 设置方法不同，下面分别介绍。</p><h3>windows</h3><p>参考之前的文章：<a href="https://blog.niekun.net/archives/413.html">https://blog.niekun.net/archives/413.html</a></p><h3>macos</h3><p>确定您的 shell 类型。打开终端，运行以下命令：</p><pre><code>echo $SHELL
</code></pre><p>这通常会返回 <strong>/bin/zsh</strong> 或 <strong>/bin/bash</strong>。</p><!--more--><p>根据您的 shell 类型，编辑相应的配置文件：</p><p>对于 Zsh（最新的 macOS 默认使用）：编辑 <strong>~/.zshrc</strong><br>对于 Bash：编辑 <strong>~/.bash_profile</strong> 或 <strong>~/.bashrc</strong></p><p>使用文本编辑器打开相应的文件。例如，对于 zsh：</p><pre><code>vim ~/.zshrc
</code></pre><p>在文件末尾添加以下行（替换为您的实际脚本目录路径）：</p><pre><code>export PATH=&quot;/path/script:$PATH&quot;
</code></pre><p>保存并关闭文件。使更改生效，可以重新加载配置文件或重启终端。要重新加载，运行：</p><pre><code>source ~/.zshrc  # 如果使用 Zsh
source ~/.bash_profile  # 如果使用 Bash
</code></pre><p>验证 PATH 更新：</p><pre><code>echo $PATH
</code></pre><p>您应该能看到您的脚本目录已被添加。现在，您应该能够直接运行脚本，而不需要指定完整路径：</p><pre><code>test.sh
</code></pre><p>注意事项：</p><ul><li>确保您的脚本有正确的执行权限（<code>chmod +x script_name.sh</code>）。</li><li>如果脚本名称与系统命令冲突，考虑重命名脚本或使用唯一前缀</li></ul>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/path.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/path.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[解决在 intel 12代以后的 CPU 上 vmwre 虚拟机性能低下问题]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/intel-12-CPU-vmwre.html" />
<id>https://blog.niekun.net/archives/intel-12-CPU-vmwre.html</id>
<updated>2024-04-18T13:01:52+08:00</updated>
<published>2024-04-18T13:01:52+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<category scheme="https://blog.niekun.net/category/other/" term="other" />
<summary type="html"><![CDATA[最近更换了新的电脑，是 i7 12700H 的 CPU，按理说比以前的电脑性能好一些，但是导入之前的 vmware 虚拟机后发现运行起来优点卡顿，但是观察主机资源占用很低，cpu 占用也很低，研...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/intel-12-CPU-vmwre.html" xml:lang="zh-CN"><![CDATA[
<p>最近更换了新的电脑，是 i7 12700H 的 CPU，按理说比以前的电脑性能好一些，但是导入之前的 vmware 虚拟机后发现运行起来优点卡顿，但是观察主机资源占用很低，cpu 占用也很低，研究了下才发现是由于新款 cpu 采用了大小核设计导致这个问题。</p><p>我的这一款是 6 大核 8 小核 20 线程设计。默认情况下启动虚拟机资源分配是交给 windows 主机自己协调的，很可能会分配给小核运行虚拟机导致运行卡顿，资源管理器可以看到 cpu 负载都在后面的小核上：<br><img src="https://blog.niekun.net/usr/uploads/2024/04/1346184507.png" alt="image.png" title="image.png"></p><p>解决方法就是以管理员权限运行 vmware，这样 VMware 会自己调度资源使用，优先级大概是大核&gt;小核&gt;超线程。实际效果很明显，基本都运行在了大核上：<br><img src="https://blog.niekun.net/usr/uploads/2024/04/2751437887.png" alt="image.png" title="image.png"></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/intel-12-CPU-vmwre.html#comments" thr:count="1" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/intel-12-CPU-vmwre.html" thr:count="1"/>
</entry>
<entry>
<title type="html"><![CDATA[windows 相对路径快捷方式]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/windows.html" />
<id>https://blog.niekun.net/archives/windows.html</id>
<updated>2024-03-18T10:09:15+08:00</updated>
<published>2024-03-18T10:09:15+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<summary type="html"><![CDATA[一般系统默认创建的都是指向某个文件绝对路径的快捷方式，如果移动原始文件位置后，快捷方式就失效了。可以自己修改快捷方式的属性来建立一个以快捷方式所在地址为准的指向一个相对路径的文件。这样适用于需要...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/windows.html" xml:lang="zh-CN"><![CDATA[
<p>一般系统默认创建的都是指向某个文件绝对路径的快捷方式，如果移动原始文件位置后，快捷方式就失效了。</p><p>可以自己修改快捷方式的属性来建立一个以快捷方式所在地址为准的指向一个相对路径的文件。这样适用于需要同时移动原始文件与快捷方式的情况。</p><p>首先右键创建一个文件的快捷方式，然后右键选择快捷方式的属性，将目标位置地址改为：<code>explorer.exe path/to/file.exe</code>。注意 <strong>explorer.exe</strong> 后面的空格：<br><img src="https://blog.niekun.net/usr/uploads/2024/03/3004501885.png" alt="image.png" title="image.png"></p><p>后面的路径就是相对于快捷方式地址的相对路径。</p><p>确认后默认快捷方式图标会变成资源管理器的图标，可以在属性里修改为其他图标。</p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/windows.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/windows.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[WSA (Windows Subsystem for Android) 的安装及使用]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/WSA-Windows-Subsystem-for-Android.html" />
<id>https://blog.niekun.net/archives/WSA-Windows-Subsystem-for-Android.html</id>
<updated>2024-02-20T15:47:00+08:00</updated>
<published>2024-02-20T15:47:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<category scheme="https://blog.niekun.net/category/other/" term="other" />
<summary type="html"><![CDATA[之前介绍过 Windows10 安装 wsl 的教程，可以方便的在 Windows 下使用 Ubuntu 系统。今天介绍安装 wsa 用来在 Windows 下使用 Android 系统及安装第...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/WSA-Windows-Subsystem-for-Android.html" xml:lang="zh-CN"><![CDATA[
<p>之前介绍过 Windows10 安装 wsl 的教程，可以方便的在 Windows 下使用 Ubuntu 系统。今天介绍安装 wsa 用来在 Windows 下使用 Android 系统及安装第三方 apk。</p><h3>安装</h3><p>wsa 没有在官方的 store 中提供，这里使用开源的 WSA-Script 很方便的一键安装。</p><p>GitHub 主页：<a href="https://github.com/YT-Advanced/WSA-Script">https://github.com/YT-Advanced/WSA-Script</a></p><p>在 release 页面下载最新打包的版本：<a href="https://github.com/YT-Advanced/WSA-Script/releases/latest">https://github.com/YT-Advanced/WSA-Script/releases/latest</a></p><!--more--><p>我需要使用 google play 框架及 root 权限，所以下载的是框出来的版本：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/557081804.png" alt="image.png" title="image.png"></p><p>下载好解压到一个特定的目录，运行 <code>Run.bat</code>，期间会提示需要管理员权限以及提示收集信息的对话框，点击<strong>确认</strong>即可。</p><p>安装完成后会自动运行 Windows Subsystem For Android™ 应用。</p><h3>设置代理</h3><p>如果需要使用 play 商店，就需要配置代理服务。如果本机有代理工具的话，可以让 wsa 直接调用本机代理。这里需要使用 adb 工具，下载链接：<a href="https://dl.google.com/android/repository/platform-tools-latest-windows.zip">https://dl.google.com/android/repository/platform-tools-latest-windows.zip</a></p><p>解压压缩包，可以看到其中有一个 <code>adb.exe</code>，可以将目录添加到系统 path 以方便在 terminal 调用。</p><p>首先需要设置 wsa 打开开发者模式，进入设置打开选项：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/1039626403.png" alt="image.png" title="image.png"></p><p>默认 wsa 是运行在本地的 <strong>58526</strong> 端口的。</p><p>建立一个 powershell 脚本，如：wsaproxy.ps1，内容如下：</p><pre><code>$WinNetIP=$(Get-NetIPAddress -InterfaceAlias 'vEthernet (WSLCore)' -AddressFamily IPV4) # get android network gateway addr
adb connect 127.0.0.1:58526 # android port
adb shell settings put global http_proxy &quot;$($WinNetIP.IPAddress):1082&quot; # local proxy port</code></pre><p>第一次执行会弹出对话框是否信任外部访问，点击允许即可。</p><p>以上脚本会获取到 wsa 所在网卡的网关地址，然后用 adb 连接到 wsa，最后配置代理，注意脚本里的本地代理端口修改为实际值即可。</p><p>运行脚本即可让 wsa 配置好代理服务。以后只需要执行这个脚本就可以自动设置代理。</p><p>如果需要取消代理运行下面命令即可：</p><pre><code>adb shell settings put global http_proxy :0</code></pre><h3>安装 apk</h3><p>推荐直接在 play 商店安装应用程序，如果需要安装自己下载的第三方 apk，直接使用 adb 工具即可。</p><p>安装命令：</p><pre><code>adb connect 127.0.0.1:58526
adb install xxx.apk</code></pre><h3>文件共享</h3><p>可以配置一个 Windows 主机的路径作为同 wsa 共享目录，这样两边就可以互传文件了。</p><p>打开 Windows Subsystem For Android™ 进入 <strong>advanced settings - experimental feature</strong>，启用 <strong>share user folders</strong> 功能并选择一个本地目录作为共享目录：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/2995143306.png" alt="image.png" title="image.png"></p><p>通过 <strong>system - turnoff</strong> 关闭 wsa，然后点击 <strong>files</strong> 会重新运行 wsa：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/1695157306.png" alt="image.png" title="image.png"></p><p>可以看到有一个 windows 文件夹：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/3450453039.png" alt="image.png" title="image.png"></p><p>这个文件夹就是对应的 windows 共享目录。</p><h3>系统设置</h3><p>默认情况下只有在第一次安装成功后会自动启动 Android 设置界面，并且找不到设置的启动图标在哪里，我们可以在浏览器里直接访问 android settings 地址的方式启动。</p><p>浏览器中输入以下地址并访问：<a href="#">wsa://com.android.settings</a>，会提示是否需要跳转到设置，点击确认即可进入设置：<br><img src="https://blog.niekun.net/usr/uploads/2024/02/969734695.png" alt="image.png" title="image.png"></p><h3>参考链接</h3><p><a href="https://www.tjsky.net/tutorial/391">Windows Android 子系统 WSA 代理设置方法教程</a><br><a href="https://zhuanlan.zhihu.com/p/459444929">WSA (Windows Subsystem for Android) 使用 Windows 上的代理</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/WSA-Windows-Subsystem-for-Android.html#comments" thr:count="1" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/WSA-Windows-Subsystem-for-Android.html" thr:count="1"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 下虚拟机安装 MacOS]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2860.html" />
<id>https://blog.niekun.net/archives/2860.html</id>
<updated>2023-11-03T09:08:00+08:00</updated>
<published>2023-11-03T09:08:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<category scheme="https://blog.niekun.net/category/macos/" term="macOS" />
<summary type="html"><![CDATA[经过测试，我的电脑安装好后可以启动，但是每次输入管理员口令就会四国。可能和我的电脑 cpu 不能完美支持 macos 内核有关，下面介绍安装方法。工具：vmware workstationunl...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2860.html" xml:lang="zh-CN"><![CDATA[
<p>经过测试，我的电脑安装好后可以启动，但是每次输入管理员口令就会四国。可能和我的电脑 cpu 不能完美支持 macos 内核有关，下面介绍安装方法。</p><p>工具：</p><ul><li>vmware workstation</li><li><a href="https://github.com/DrDonk/unlocker">unlocker</a></li><li><a href="https://techrechard.com/download-macos-monterey-iso-dmg-and-vmdk/#Download_macOS_Monterey_ISO_file">macos Monterey iso image</a></li></ul><!--more--><h3>环境准备</h3><p>首先需要主板支持虚拟化 VT，需要在 bios 中打开对应选项。注意此项必须配置，否则安装会不成功。</p><p>VMware workstation 默认不支持安装 macos，需要使用第三方工具 unlocker 来开启支持，直接在上方提供的 github 主页下载最新版本即可，运行 windows 文件夹下的 unlock.exe 即可。</p><p>然后下载 macos iso 镜像文件，在我上面提供的网站中下载即可。</p><h3>配置虚拟机</h3><p>按照正常的新建虚拟机的方式新建，添加下载好的系统镜像用来安装，配置好确认后先不要启动虚拟机，先修改对应虚拟机文件夹下的 vmx 文件。</p><p>文本编辑器打开 vmx 文件后，在最后一行添加一句：</p><pre><code>smc.version = 0
</code></pre><p>保存后即可启动虚拟机，进入 recovery 工具后，先格式化硬盘，然后安装系统，提示一步步安装即可。</p><h3>参考链接</h3><p><a href="https://techrechard.com/how-to-install-macos-monterey-on-vmware-on-windows-pc/">How To Install macOS Monterey On Vmware On Windows Pc</a><br><a href="https://zhuanlan.zhihu.com/p/658521465">Windows用VM虚拟机安装MacOS Ventura 13.6系统全流程教程</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2860.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2860.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[命令行激活 Windows 密钥]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2770.html" />
<id>https://blog.niekun.net/archives/2770.html</id>
<updated>2022-09-19T09:22:00+08:00</updated>
<published>2022-09-19T09:22:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<summary type="html"><![CDATA[注意：安装新密钥及激活时需要在管理员权限下运行终端。安装新密钥，会自动替换当前密钥：slmgr /ipk xxxx-xxxx-xxxx-xxxx-xxxx激活 Windows：slmgr /at...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2770.html" xml:lang="zh-CN"><![CDATA[
<p>注意：安装新密钥及激活时需要在<strong>管理员权限</strong>下运行终端。</p><p>安装新密钥，会自动替换当前密钥：</p><pre><code>slmgr /ipk xxxx-xxxx-xxxx-xxxx-xxxx
</code></pre><p>激活 Windows：</p><pre><code>slmgr /ato
</code></pre><p>显示当前授权信息：</p><pre><code>slmgr /dli
</code></pre><p>显示详细授权信息：</p><pre><code>slmgr /dlv
</code></pre><p>显示授权剩余日期：</p><pre><code>slmgr /xpr
</code></pre><p>密钥可用性在线检测：<a href="https://dbmer.com/checkkey/">https://dbmer.com/checkkey/</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2770.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2770.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 配置 FTP 服务器]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2757.html" />
<id>https://blog.niekun.net/archives/2757.html</id>
<updated>2022-09-15T15:04:00+08:00</updated>
<published>2022-09-15T15:04:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<summary type="html"><![CDATA[Windows 10 以上系统自带 FTP server，可以简单的搭建一个局域网内应用的 FTP 服务器。下面介绍具体操作流程。搜索 windows feature 打开功能开关配置界面：]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2757.html" xml:lang="zh-CN"><![CDATA[
<p>Windows 10 以上系统自带 FTP server，可以简单的搭建一个局域网内应用的 FTP 服务器。下面介绍具体操作流程。</p><p>搜索 windows feature 打开功能开关配置界面：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/3236706010.png" alt="2022-09-15T06:50:53.png" title="2022-09-15T06:50:53.png"></p><!--more--><p>开启如下 ftp 相关选项，确认后等待安装完成：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/3759793436.png" alt="2022-09-15T06:51:58.png" title="2022-09-15T06:51:58.png"></p><p>搜索 Administrative Tools：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/4127207686.png" alt="2022-09-15T06:53:05.png" title="2022-09-15T06:53:05.png"></p><p>双击 Internet Information Services (IIS) Manager:<br><img src="https://blog.niekun.net/usr/uploads/2022/09/2046309272.png" alt="2022-09-15T06:53:58.png" title="2022-09-15T06:53:58.png"></p><p>sites 上右键点击 add ftp site：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/205395891.png" alt="2022-09-15T06:55:25.png" title="2022-09-15T06:55:25.png"></p><p>设置名称及共享路径：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/1391443548.png" alt="2022-09-15T06:56:18.png" title="2022-09-15T06:56:18.png"></p><p>选择无 ssl：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/2363422074.png" alt="2022-09-15T06:56:43.png" title="2022-09-15T06:56:43.png"></p><p>选择 basic 验证以及指定可登录 FTP 的用户，设置读写权限：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/2397564596.png" alt="2022-09-15T06:57:40.png" title="2022-09-15T06:57:40.png"></p><p>可以单独建立一个用户用来登录 ftp，建立账户可以参考我的教程：<a href="https://blog.niekun.net/archives/2103.html#title-4">https://blog.niekun.net/archives/2103.html#title-4</a></p><p>设置完成后，点击完成即可。</p><p>然后配置防火墙例外，搜索 allow an app through windows firewall:<br><img src="https://blog.niekun.net/usr/uploads/2022/09/4066124525.png" alt="2022-09-15T06:59:18.png" title="2022-09-15T06:59:18.png"></p><p>在列表中找到 ftp server 并打勾即可：<br><img src="https://blog.niekun.net/usr/uploads/2022/09/3519377408.png" alt="2022-09-15T07:00:53.png" title="2022-09-15T07:00:53.png"></p><p>以上就完成了 Windows 端 ftp 服务器的搭建，可以使用 ftp 客户端登录此 ftp 服务器了。</p><p><strong>参考链接：</strong><br><a href="https://www.windowscentral.com/how-set-ftp-server-windows-10">How to set up and manage an FTP server on Windows 10</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2757.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2757.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[解除 Windows 11 TPM 或 CPU 限制]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2340.html" />
<id>https://blog.niekun.net/archives/2340.html</id>
<updated>2021-10-08T11:58:00+08:00</updated>
<published>2021-10-08T11:58:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<summary type="html"><![CDATA[最近微软发布了 Windows 11 正式版。但是对设备硬件有一些限制，可以通过修改注册表的方式解除限制。首先打开注册表，快捷键 win + R，输入 regedit：]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2340.html" xml:lang="zh-CN"><![CDATA[
<p>最近微软发布了 Windows 11 正式版。但是对设备硬件有一些限制，可以通过修改注册表的方式解除限制。</p><p>首先打开注册表，快捷键 <code>win + R</code>，输入 regedit：<br><img src="https://blog.niekun.net/usr/uploads/2021/10/2068741883.png" alt="2021-10-08T03:51:00.png" title="2021-10-08T03:51:00.png"></p><!--more--><p>通过左侧层级菜单找到：<code>Computer\HKEY_LOCAL_MACHINE\SYSTEM\Setup\MoSetup</code>:<br><img src="https://blog.niekun.net/usr/uploads/2021/10/3148204400.png" alt="2021-10-08T03:52:28.png" title="2021-10-08T03:52:28.png"></p><p>选中 Mosetup，菜单栏选择 <strong>edit</strong> - <strong>New</strong> - <strong>DWORD</strong> 添加新键，重命名为：<code>AllowUpgradesWithUnsupportedTPMOrCPU</code>：<br><img src="https://blog.niekun.net/usr/uploads/2021/10/2409459988.png" alt="2021-10-08T03:54:27.png" title="2021-10-08T03:54:27.png"></p><p>双击此键设置值为 1，然后确认：<br><img src="https://blog.niekun.net/usr/uploads/2021/10/401781102.png" alt="2021-10-08T03:55:45.png" title="2021-10-08T03:55:45.png"></p><p>然后就可以下载镜像安装了，期间会提示硬件不符合要求，但多了个<strong>接受</strong>选项安装 Windows 11：<br><img src="https://blog.niekun.net/usr/uploads/2021/10/2409503880.png" alt="2021-10-08T03:57:47.png" title="2021-10-08T03:57:47.png"></p><h3>升级故障</h3><p>在实际升级中，我遇到了一个困扰几个星期的问题，当显示升级进度到 31% 的时候就停留不动了，尝试了无数次都无法解决。最后在今天翻看台湾 Windows 社群的时候找到了一篇帖子，受到启发才找到了问题点。</p><p>一般这种问题都是因为当前系统内安装的某个硬件的驱动有问题导致升级无法进行，我们需要做的就是找到这个驱动是什么然后卸载它。</p><p>我们需要从 <code>C:\$WINDOWS.~BT\Sources\Panther</code> 目录内的 <code>CompatData_</code> 开头的 xml 文件中找到 DriverPackages 标签的内容，找到 BlockMigration="True" 后面的 inf="XXX.inf" 记住这里的 inf 文件名称，在 <code>C:\Windows\INF</code> 目录中找到对应的 inf 文件，用记事本打开文件，查看这到底是什么驱动，根据驱动名称和驱动版本等信息，在设备管理器中找到对应驱动并卸载它。</p><p>如果 xml 文件中没有找到相关信息，则需要在 <code>C:\$WINDOWS.~BT\Sources\Panther</code> 目录内 <code>setupact.log</code> 文件中找相关信息，一般我们直接翻到日志最后一部分，查找相关信息，同样是找到 XXX.inf 文件。</p><p>正确的找到并卸载驱动后，需要删除 <code>C:\$WINDOWS.~BT\Sources\Panther</code> 中的 <code>compatscancache.dat</code> 和 <code>CompatData_</code> 开头的 xml 文件。然后就可以测试再次启动升级。</p><h3>参考链接</h3><p><a href="https://answers.microsoft.com/zh-hant/windows/forum/all/windows-11%E6%9B%B4%E6%96%B0%E5%8D%A1%E5%9C%A835/550eb56f-11b8-4a37-a23d-c823a1024555">windows 11更新卡在35%</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2340.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2340.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 主机使用 VMware 虚拟机在共享文件夹调试 node.js 时 npm install 报错问题的处理]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2139.html" />
<id>https://blog.niekun.net/archives/2139.html</id>
<updated>2021-02-07T11:07:10+08:00</updated>
<published>2021-02-07T11:07:10+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<category scheme="https://blog.niekun.net/category/js/" term="javascript" />
<summary type="html"><![CDATA[由于 node.js 在 Windows 下会有各种问题，最好的开发环境还是 Linux，所以我通过 VMware 内安装 Ubuntu 虚拟机的方式学习 node.js。我的流程是：VMwar...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2139.html" xml:lang="zh-CN"><![CDATA[
<p>由于 node.js 在 Windows 下会有各种问题，最好的开发环境还是 Linux，所以我通过 VMware 内安装 Ubuntu 虚拟机的方式学习 node.js。</p><p>我的流程是：</p><ul><li>VMware 安装 Ubuntu</li><li>共享 Windows 下的文件夹给 Ubuntu 作为开发目录</li><li>Windows 下使用 vs code 通过 ssh 方式远程连接 Ubuntu</li></ul><p>通过远程连接的方式在 Windows 下做 node.js 开发实际体验很好。但是在通过 npm 安装某些包时常常会有报错出现，错误日志大概意思就是说无法给 node_modules 文件夹内安装的库文件添加软连接到系统路径。</p><p>网上查询后发现了问题原因，我的开发目录实际是在 Windows 下的，Windows 和 Linux 有着不一样的文件系统和路径格式，所以 npm 在安装某些包含 bin 可执行文件的第三方库时，会默认自动创建相关文件的软链接到 Linux 系统路径，这样就就报错了。</p><p>如果要坚持使用共享目录的形式做开发，那么需要设置在 npm 安装新库时使用参数 <code>--no-bin-links</code> 告诉系统不要自动创建软连接，语法如下：</p><pre><code>npm install cowsay --no-bin-links
</code></pre><p>这样就会跳过相关步骤。</p><p>也可以设置到 npm 配置中，这样以后安装的包都会默认不创建 bin 的软连接了：</p><pre><code>npm config set bin-links false
</code></pre><p>当然最理想的方式就是将开发路径放置在 Linux 系统中，而不是通过共享目录的形式。这样就是一个纯原生的环境。</p><p>参考链接：<a href="https://github.com/npm/npm/issues/2221">https://github.com/npm/npm/issues/2221</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2139.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2139.html" thr:count="0"/>
</entry>
<entry>
<title type="html"><![CDATA[Windows 配置安全的 smb 共享]]></title>
<link rel="alternate" type="text/html" href="https://blog.niekun.net/archives/2103.html" />
<id>https://blog.niekun.net/archives/2103.html</id>
<updated>2021-02-03T10:28:00+08:00</updated>
<published>2021-02-03T10:28:00+08:00</published>
<author>
    <name>admin</name>
    <uri>https://niekun.net</uri>
</author>
<category scheme="https://blog.niekun.net/category/Windows/" term="Windows" />
<summary type="html"><![CDATA[最近研究了下 Windows 的共享设置，目的是在同一局域网下共享文件夹给其他设备读写。下面从原理和实际操作上介绍下共享过程。SMBWindows 共享使用 Server Message Blo...]]></summary>
<content type="html" xml:base="https://blog.niekun.net/archives/2103.html" xml:lang="zh-CN"><![CDATA[
<p>最近研究了下 Windows 的共享设置，目的是在同一局域网下共享文件夹给其他设备读写。下面从原理和实际操作上介绍下共享过程。</p><h3>SMB</h3><p>Windows 共享使用 Server Message Block (SMB) 协议，它可以让应用程序访问本机网络下的其他设备的文件及服务。</p><p>SMB 是 IBM 在 1980 年代创造的协议，目前已经有了很多的升级及分支。</p><p>SMB 协议允许应用程序访问远程主机的文件和资源如打印机等，也可以同远程主机上设置了接收 SMB 协议的应用程序通信。它运行在网络的 layer 7 层，也就是 application 应用层，使用 TCP/IP 的 445 端口传输数据。</p><p>从 Windows 95 开始，微软将引入了 SMB 协议的支持。Linux 端，samba 作为一个开源软件提供 SMB 的支持。</p><!--more--><p>SMB 协议也是在不断发展的，下面是一个简单的版本更新过程：</p><ul><li>SMB 1.0 (1984): IBM 为 DOS 下的文件共享创造了 SMB</li><li>CIFS (1996): 微软开发了 SMB 的分支版本并集成在 Windows 95，添加了大文件的支持，直接在 TCP/IP 传输</li><li>SMB 2.0 (2006): 在 Windows Vista 和 Windows Server 2008 中发布. 提升了性能</li><li>SMB 2.1 (2010): 在 Windows Server 2008 R2 和 Windows 7 中发布</li><li>SMB 3.0 (2012): 在 Windows 8 和 Windows Server 2012 中发布. 提升了性能，增加备份，安全和管理功能</li><li>SMB 3.02 (2014): 在 Windows 8.1 和 Windows Server 2012 R2 中发布. 提升性能并完全停止支持 CIFS/SMB 1.0</li><li>SMB 3.1.1 (2015): 在 Windows 10 和 Windows Server 2016 中发布</li></ul><p>在 2017 年，利用 SMB 1.0 的漏洞，WannaCry 勒索软件在互联网中大规模传播，微软虽然立刻发布了补丁，但专家还是建议立刻停止运行 SMB 1.0 协议。</p><p>下面介绍在 Windows 10 中配置共享文件夹。</p><h3>关闭 smb1.0</h3><p>由于 smb1.0 过于久远且不安全，所以我们最好将其关闭，默认情况下系统中他也是关闭的。</p><p>系统搜索并打开 <strong>打开或关闭 Windows 功能 turn windows features on or off</strong>：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/821597621.png" alt="2022-01-29T00:10:24.png" title="2022-01-29T00:10:24.png"></p><p>在其中找到 smb1.0 并将其关闭，可能会提示需要重启系统：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/1259310687.png" alt="2022-01-29T00:12:10.png" title="2022-01-29T00:12:10.png"></p><h3>Windows 设置共享</h3><p>下面配置共享， 步骤如下：</p><ul><li>新建一个用户专门用于共享文件的授权，并合理设置此用户的权限；</li><li>合理设置网络共享和系统安全的相关设置；</li><li>开启共享，授权指定用户；</li></ul><h3>创建专用用户</h3><p>搜索并打开<strong>计算机管理 computer management</strong>：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3133817032.png" alt="2022-01-29T00:17:14.png" title="2022-01-29T00:17:14.png"></p><p>找到本地用户和组，点击用户文件夹：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3048535989.png" alt="2022-01-29T00:19:28.png" title="2022-01-29T00:19:28.png"></p><p>右键点击 new user 创建新用户，设置用户名和密码，下面选中用户不可修改密码和密码永不过期：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/94458589.png" alt="2022-01-29T00:22:07.png" title="2022-01-29T00:22:07.png"></p><h3>配置用户权限</h3><p>首先禁用<strong>启用不安全的来宾登录</strong>，win + r 搜索 gpedit.msc <strong>本地组策略编辑器</strong>:<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3532410280.png" alt="2022-01-29T00:26:11.png" title="2022-01-29T00:26:11.png"></p><p>如下路径找到选项：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/1248800284.png" alt="2022-01-29T00:27:25.png" title="2022-01-29T00:27:25.png"></p><p>双击进入设置，关闭此选项并确认：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/2620462993.png" alt="2022-01-29T00:28:10.png" title="2022-01-29T00:28:10.png"></p><p>然后 win + r 搜索 secpol.msc 打开<strong>本地安全策略</strong>，配置本地用户权限分配：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/1510636439.png" alt="2022-01-29T00:30:48.png" title="2022-01-29T00:30:48.png"></p><p>首先配置可以从网络访问本机的用户：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/1097192264.png" alt="2022-01-29T00:32:43.png" title="2022-01-29T00:32:43.png"></p><p>双击进入后点击 add user 添加我们刚刚创建的用户：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/4205064312.png" alt="2022-01-29T00:34:16.png" title="2022-01-29T00:34:16.png"></p><p>在下方输入我们创建的用户名，然后点击右侧的 check names 自动匹配用户名：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/512132529.png" alt="2022-01-29T00:35:16.png" title="2022-01-29T00:35:16.png"><br><img src="https://blog.niekun.net/usr/uploads/2022/01/2012220486.png" alt="2022-01-29T00:35:39.png" title="2022-01-29T00:35:39.png"></p><p>确认后再列表中就出现了对应用户，注意如果列表中有 everyone 等其他用户时，为了安全起见可以将它们从列表中删除。完成后点击 ok 确认修改。</p><p>然后配置这个用户<strong>拒绝本地登录</strong>和<strong>拒绝远程桌面登录</strong>，因为我们创建这个用户只是为了 smb 共享登录使用。也是在本地用户权限分配页面找到对应选项并配置此用户到列表：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3621678614.png" alt="2022-01-29T00:41:31.png" title="2022-01-29T00:41:31.png"></p><h3>开启有保护的共享</h3><p>首先打开控制面板，进入 network and Internet：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/3484356955.jpg" alt="1.jpg" title="1.jpg"></p><p>点击 network and sharing center：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/1555287216.jpg" alt="2.jpg" title="2.jpg"></p><p>点击 change advanced sharing settings：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/3540072456.jpg" alt="3.jpg" title="3.jpg"></p><p>在 current profile 中打开网络发现和文件共享：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/87039655.jpg" alt="4.jpg" title="4.jpg"></p><p>然后在 all network 中打开密码保护：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/2942111656.png" alt="2022-01-29T01:15:57.png" title="2022-01-29T01:15:57.png"></p><p>控制面板配置完成后，我们开始配置需要共享的文件夹。</p><h3>文件夹共享</h3><p>在需要共享的文件夹上点击右键，选择属性：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/244669714.jpg" alt="6.jpg" title="6.jpg"></p><p>在 share 选项卡中点击 advanced share：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/1235392306.jpg" alt="11.jpg" title="11.jpg"></p><p>选中 share this folder：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/2162677218.jpg" alt="12.jpg" title="12.jpg"></p><p>点击 permission：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/2270117126.jpg" alt="13.jpg" title="13.jpg"></p><p>如果有先将 everyone 用户删掉，然后点击 add 添加 marco 用户，点击 check names 自动补全：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/562337372.png" alt="2022-01-29T01:22:28.png" title="2022-01-29T01:22:28.png"></p><p>然后配置用户权限，根据需要设置读写权限，这里直接选中 full control：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3242220406.png" alt="2022-01-29T01:23:50.png" title="2022-01-29T01:23:50.png"></p><p>然后还有一步很重要，设置 marco 用户对此共享文件夹具有访问权限，否则也会提示无法访问文件夹，点击 security：<br><img src="https://blog.niekun.net/usr/uploads/2022/07/1436686678.png" alt="2022-07-01T03:36:45.png" title="2022-07-01T03:36:45.png"></p><p>如果用户列表里没有 marco 用户，则需要添加进去，点击 edit 添加用户，方法和上面的方法类似，最后 marco 用户在列表里面即可，可以配置用户权限：<br><img src="https://blog.niekun.net/usr/uploads/2022/07/960624335.png" alt="2022-07-01T03:38:40.png" title="2022-07-01T03:38:40.png"></p><p>点击 ok 保存设置。</p><p>确认后共享文件夹就配置完成了。</p><h3>访问共享文件</h3><p>下面介绍在其他局域网设备访问主机的共享文件夹。</p><h4>Windows</h4><p>在 Windows 上，打开 file explorer，点击 network：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/3714944153.jpg" alt="15.jpg" title="15.jpg"></p><p>在右侧就是本地网络下启用了网络发现的设备列表，点击进入设置了共享文件夹的设备名称，根据提示输入配置好的用户名和密码就可以访问了：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/1841189733.jpg" alt="16.jpg" title="16.jpg"></p><p>也可以在地址栏直接输入共享路径地址，以双反斜线<code>\\</code>开头后面是设备 IP 或名称，如：<code>\\DESKTOP-BS3C55D</code>。</p><p>关于设备的名称，可以在终端通过 <code>whoami</code> 命令查询：<br><img src="https://blog.niekun.net/usr/uploads/2021/02/969206228.jpg" alt="17.jpg" title="17.jpg"></p><h4>iPhone</h4><p><strong>在支持 SMB 协议的设备或应用程序中都可以打开 Windows 共享的文件</strong>，下面介绍通过 iPhone 的 files app 来连接到 Windows 共享目录。</p><p><strong>打开 files app，点击右上角的 <code>...</code> 选择 connect to server：</strong><br><img src="https://blog.niekun.net/usr/uploads/2021/02/765618703.jpg" alt="IMG_3227.jpg" title="IMG_3227.jpg"></p><p><strong>在 server 中输入共享主机的地址，这里直接输入 IP 地址：</strong><br><img src="https://blog.niekun.net/usr/uploads/2021/02/323133738.png" alt="IMG_3229.PNG" title="IMG_3229.PNG"></p><p><strong>输入用户名和密码，完成后就可以访问到共享目录了：</strong><br><img src="https://blog.niekun.net/usr/uploads/2021/02/989176749.png" alt="IMG_3232.PNG" title="IMG_3232.PNG"></p><p>如果文件夹设置的是可读写权限，就可以在手机上传输文件到共享目录了。</p><p>参考链接：<br><a href="https://searchnetworking.techtarget.com/definition/Server-Message-Block-Protocol">Server Message Block Protocol (SMB protocol)</a><br><a href="https://post.smzdm.com/p/akxwkxqk/">Windows 10/ 11 下安全并正确地使用 SMB 共享</a></p>
]]></content>
<link rel="replies" type="text/html" href="https://blog.niekun.net/archives/2103.html#comments" thr:count="0" />
<link rel="replies" type="application/atom+xml" href="https://blog.niekun.net/feed/atom/category/Windows/archives/2103.html" thr:count="0"/>
</entry>
</feed>