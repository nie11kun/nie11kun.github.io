<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
xmlns:atom="http://www.w3.org/2005/Atom"
xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
<title>Marco Nie</title>
<link>https://blog.niekun.net/</link>
<atom:link href="https://blog.niekun.net/feed/" rel="self" type="application/rss+xml" />
<language>zh-CN</language>
<description>you are the company you keep...</description>
<lastBuildDate>Tue, 29 Mar 2022 17:07:00 +0800</lastBuildDate>
<pubDate>Tue, 29 Mar 2022 17:07:00 +0800</pubDate>
<item>
<title>通过频率分离修复褶皱衣服 in Photoshop</title>
<link>https://blog.niekun.net/archives/2480.html</link>
<guid>https://blog.niekun.net/archives/2480.html</guid>
<pubDate>Tue, 29 Mar 2022 17:07:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2022/03/4069145759.png" alt="2022-03-29T06:05:20.png" title="2022-03-29T06:05:20.png"></p><p>之前介绍过通过高低频率分离可以处理皮肤柔化，它可以方便的单独处理颜色和反差部分。下面介绍通过高低频分离将褶皱的衣服平顺化，同时保持其原有的真实过渡部分。</p><p>用到的技术主要有：高斯模糊、apply image、linear light、mixer brush tool、patch tool</p><!--more--><p>原图如下，可以看到衣服褶皱很明显：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2440759349.png" alt="2022-03-29T09:08:08.png" title="2022-03-29T09:08:08.png"></p><p>首先复制两个图层，分别命名为 color 和 texture：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/1204853365.png" alt="2022-03-29T08:26:51.png" title="2022-03-29T08:26:51.png"></p><p>先临时关闭 texture 图层，将 color 图层执行高斯模糊：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/1213210024.png" alt="2022-03-29T08:29:40.png" title="2022-03-29T08:29:40.png"></p><p>根据实际情况，调节滑块将主体的布料细节等杂乱色彩柔化，最终基本看不出明显细节：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2181621932.png" alt="2022-03-29T08:32:15.png" title="2022-03-29T08:32:15.png"></p><p>然后打开 texture 图层，执行 image - apply image。layer 选择 下方的 color 图层，混合模式选择 subtract，scale 选择 2，offset 设置为 128，上面设置的意思就是将 texture 图层每个像素都减去下方的 color 图层，将结果减为 0 的部分填充为 50度灰色，scale 影响轮廓范围：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2255720486.png" alt="2022-03-29T08:33:17.png" title="2022-03-29T08:33:17.png"></p><p>然后将 texture 混合模式改为 linear light，我们会发现现在显示的图像和原图是一样的：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2429814177.png" alt="2022-03-29T08:36:54.png" title="2022-03-29T08:36:54.png"></p><p>以上我们就将原图拆解为 color 和 texture 两部分，可以对其进行分别调整。</p><p>下面我们开始处理褶皱问题，关闭 texture 图层，然后使用 mixer brush tool 将 color 图层颜色分布均匀化处理，这个笔刷可以选取周围图片某个地方的像素，然后在其他地方可以涂抹出相似的颜色。</p><p>由于需要使用色彩选取功能，首先我们确保选取颜色的时候是 3<em>3 或 5</em>5 范围而不是单个像素。</p><p>点击色彩选取工具，将上面的设置为合适数据：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3250683780.png" alt="2022-03-29T08:43:36.png" title="2022-03-29T08:43:36.png"></p><p>然后点击 mixer brush tool，在上面的默认数据基础上将流量调到30左右，将平滑处理降到0：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/136779272.png" alt="2022-03-29T08:44:53.png" title="2022-03-29T08:44:53.png"></p><p>然后使用柔边笔刷，选择一个有褶皱的区域，点击 alt 选取周边一个颜色，开始涂抹需要处理的区域，处理过程中注意不同区域需要尽量选取其周边颜色进行涂抹，这样过度更加自然。涂抹过程中可以打开背景图层观察效果：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3092609583.png" alt="2022-03-29T08:55:36.png" title="2022-03-29T08:55:36.png"></p><p>涂抹完成后打开 texture 查看效果：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2533149555.png" alt="2022-03-29T08:56:14.png" title="2022-03-29T08:56:14.png"></p><p>可以看到很明显的效果，大部分的褶皱都没有了，但是还是可以看到一些线条：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2659390146.png" alt="2022-03-29T08:57:15.png" title="2022-03-29T08:57:15.png"></p><p>但是在 color 图层却不明显，这些线条就是存在于 texture 图层的高频部分，需要在 texture 图层处理它们。</p><p>使用的方法就是通过污点修复工具将这些线条去掉，选中 texture 图层，这里我使用 patch tool：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4123661308.png" alt="2022-03-29T09:00:02.png" title="2022-03-29T09:00:02.png"></p><p>选取一个需要去除的线条，拖拽到其他完好区域，查看效果：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2338892645.png" alt="2022-03-29T09:01:51.png" title="2022-03-29T09:01:51.png"></p><p><img src="https://blog.niekun.net/usr/uploads/2022/03/1838316854.png" alt="2022-03-29T09:02:25.png" title="2022-03-29T09:02:25.png"></p><p>同样的步骤处理其他所有区域，最终效果如下：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3982807076.png" alt="2022-03-29T09:10:31.png" title="2022-03-29T09:10:31.png"></p><p>以上就完成了折痕的处理。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2480.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>彩图转黑白 in Photoshop</title>
<link>https://blog.niekun.net/archives/2472.html</link>
<guid>https://blog.niekun.net/archives/2472.html</guid>
<pubDate>Mon, 28 Mar 2022 14:04:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2022/03/3939178568.png" alt="2022-03-28T05:38:15.png" title="2022-03-28T05:38:15.png"></p><p>黑白图片在某些场景下有其独特的风格，在人像摄影中可以体现出一种另类的雕塑感，下面通过实例介绍如何从一个彩色图片处理为一张黑白效果。使用的工具主要是 gradient map 和 camera raw。</p><p>下面是原始图片：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4128302864.jpg" alt="Black and White - Gradient Map - Sample Image.jpg" title="Black and White - Gradient Map - Sample Image.jpg"></p><p>首先在原图上方建立 gradient map 图层，gradient map 的作用是根据图像的亮度分布进行颜色替换：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4117532377.png" alt="2022-03-28T05:43:51.png" title="2022-03-28T05:43:51.png"></p><p>首先将下方的 method 改为 classic，这样过渡效果更加平顺一些：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/389677896.png" alt="2022-03-28T05:47:49.png" title="2022-03-28T05:47:49.png"></p><p>默认是一个反色效果渐变，点击渐变条，修改其属性为左边黑色右边白色：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3910938814.png" alt="2022-03-28T05:46:56.png" title="2022-03-28T05:46:56.png"></p><p>下面我们增加黑白色差效果，调节左侧下方滑块可以使得黑色区域更黑，调节右侧下方滑块可以使得白色区域更白，调节中间滑块可以调节黑白区域范围：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/1041442527.png" alt="2022-03-28T05:50:16.png" title="2022-03-28T05:50:16.png"></p><p>调节到合适效果后确认即可，这样我们初步就有了一个效果。</p><p>下面为了让背景更加黑，我们通过选取提取出背景，创建一个纯黑背景。选中图像图层，选区工具下选中 select and mask：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2572737743.png" alt="2022-03-28T05:54:09.png" title="2022-03-28T05:54:09.png"></p><p>点击 select subject 可以自动选中主体：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4005078115.png" alt="2022-03-28T05:55:10.png" title="2022-03-28T05:55:10.png"></p><p>点击 color aware 和 shift edge 调节选区边沿：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2779694229.png" alt="2022-03-28T05:56:49.png" title="2022-03-28T05:56:49.png"></p><p>确认后可以获取到主体的选取，创建一个 solid color 黑色图层，选中蒙版，ctrl I 反转选区即可：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3398572673.png" alt="2022-03-28T05:58:39.png" title="2022-03-28T05:58:39.png"></p><p>放大我们可以发现主体边沿和背景没有完美的融合，这时可以通过复制刚才的 gradient map 图层强化黑白效果，然后通过笔刷工具将复制的图层只保留主体边沿部分，注意使用笔刷的时候不透明度调节稍微低一些：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4030393213.png" alt="2022-03-28T06:10:16.png" title="2022-03-28T06:10:16.png"></p><p>基本效果已经可以了，下面调节细节部分，首先眼睛需要提亮，新建 curves 图层，提亮曲线后反转蒙版，使用笔刷工具涂抹出眼睛的亮度：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/1597724556.png" alt="2022-03-28T06:15:36.png" title="2022-03-28T06:15:36.png"></p><p>黑白图片效果一般在提高锐度的时候会更加具有特点，下面我们通过 camera raw 来做调整。</p><p>首先快捷键 ctrl shift alt E 盖印图层，然后转换为 smart object 方便后期返回来调整参数：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4247719213.png" alt="2022-03-28T06:19:44.png" title="2022-03-28T06:19:44.png"></p><p>然后点击 filter - camera raw filter 进入编辑模式。</p><p>为了更加强烈的反差，我首先调节了亮度参数：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/2963793412.png" alt="2022-03-28T06:24:52.png" title="2022-03-28T06:24:52.png"></p><p>然后就是锐化的重点 - 提高 clarity 清晰度参数，注意不要调的过高而失真：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/3214151862.png" alt="2022-03-28T06:25:57.png" title="2022-03-28T06:25:57.png"></p><p>完成后保存返回 Photoshop，适当调节不透明度使图片更加自然：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/867381413.png" alt="2022-03-28T06:27:27.png" title="2022-03-28T06:27:27.png"></p><p>最终效果如下：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/4039780371.png" alt="2022-03-28T06:27:53.png" title="2022-03-28T06:27:53.png"></p><!--more-->
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2472.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>安装 phpMyAdmin 管理 MySQL</title>
<link>https://blog.niekun.net/archives/2457.html</link>
<guid>https://blog.niekun.net/archives/2457.html</guid>
<pubDate>Mon, 28 Mar 2022 09:31:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>phpMyAdmin 是一个 php 的免费工具，用来在 web 端管理 MySQL 数据库。它支持大部分的 MySQL 功能，比如：创建数据库，修改数据，管理用户权限，导入导出数据等。</p><p>官方网站：<a href="https://www.phpmyadmin.net/">https://www.phpmyadmin.net/</a><br>GitHub 主页：<a href="https://github.com/phpmyadmin/phpmyadmin">https://github.com/phpmyadmin/phpmyadmin</a></p><p>下面介绍在 Ubuntu 20.04 的安装及使用过程。</p><!--more--><h3>安装</h3><p>首先确保已经安装好了 MySQL 和 php：</p><pre><code>apt install mysql-server php php-fpm php-mysql
</code></pre><p>然后安装 phpMyAdmin：</p><pre><code>apt install phpmyadmin
</code></pre><p>安装过程中会提示创建一个 mysql 管理账户 phpmyadmin，一般直接确认即可，然后设置账户密码。如果这一步跳过了创建账户，后期需要手动修改配置文件或手动创建一个 phpmyadmin 管理账户，否则登录可能会报错。</p><h3>配置 nginx</h3><p>安装完成后需要配置代理服务器，我使用的是 nginx，下面是 nginx 的配置文件部分：</p><pre><code>    location /phpmyadmin {
        root /usr/share/;
        index index.php index.html index.htm;
        location ~ ^/phpmyadmin/(.+\.php)$ {
            fastcgi_pass unix:/run/php/php7.4-fpm.sock;
            include fastcgi-php.conf;
        }
    }</code></pre><h3>使用</h3><p>配置完成后就可以登陆 phpmyadmin 页面了，登录对应的 mysql 管理账户，可以是安装 phpmyadmin 时创建的账户也可以是我们之前使用 mysql 自己的账户：<br><img src="https://blog.niekun.net/usr/uploads/2022/03/109981368.png" alt="2022-03-28T01:25:37.png" title="2022-03-28T01:25:37.png"></p><p>如果登录后发现下面有报错信息：</p><pre><code>Access denied for user 'phpmyadmin'@'localhost' (using password: NO)
</code></pre><p>可能就是安装的时候跳过了创建 phpmyadmin MySQL 账户的步骤，这里我们可以在终端手动创建报错信息中提示的用户名或者直接修改配置文件中定义的 phpmyadmin 管理账户。</p><p>修改 <code>/etc/phpmyadmin/config.inc.php</code>，找到如下字段：</p><pre><code>$cfg['Servers'][$i]['controluser'] = 'user';
$cfg['Servers'][$i]['controlpass'] = 'password';</code></pre><p>将上面的用户名密码修改为 MySQL 中存在的账户即可。刷新页面之后应该就没有报错了。</p><p>手动创建 MySQL 用户可以参考教程：<a href="https://blog.niekun.net/archives/23.html#title-3">https://blog.niekun.net/archives/23.html#title-3</a></p><p>然后我们就可以正常使用 phpmyadmin 管理页面了，这里可以查看 database，导入导出数据等。</p><h3>参考链接</h3><p><a href="https://stackoverflow.com/questions/46736319/phpmyadmin-error-mysqli-real-connect-hy000-1045-access-denied-for-user-p">phpMyAdmin ERROR: mysqli_real_connect(): (HY000/1045): Access denied for user 'pma'@'localhost' (using password: NO)</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2457.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>使用 rclone 管理网盘文件</title>
<link>https://blog.niekun.net/archives/2454.html</link>
<guid>https://blog.niekun.net/archives/2454.html</guid>
<pubDate>Mon, 14 Mar 2022 11:35:31 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>之前介绍了通过 gdrive 在服务器上管理 Google drive 文件，实现服务器数据备份自动上传功能。最近发现有一个新的开源项目 rclone 支持更多的网盘，同时更新迭代速度也更快。</p><p>GitHub 主页：<a href="https://github.com/rclone/rclone">https://github.com/rclone/rclone</a></p><p>他支持的网盘列表：<a href="https://rclone.org/overview/">https://rclone.org/overview/</a></p><p>下面介绍它的安装使用方法。</p><!--more--><h3>安装</h3><p>Linux 下一键安装命令：</p><pre><code>curl https://rclone.org/install.sh | sudo bash
</code></pre><p>macos 通过 brew 安装：</p><pre><code>brew install rclone
</code></pre><h3>配置</h3><p>首次运行执行初始化配置：</p><pre><code>rclone config
</code></pre><p>根据提示创建新 remote：</p><pre><code>No remotes found - make a new one
n) New remote
r) Rename remote
c) Copy remote
s) Set configuration password
q) Quit config
n/r/c/s/q&gt; n</code></pre><p>然后设置此连接名称，后续就是通过这个名称来操作不同的网盘的：</p><pre><code>name&gt; remote
</code></pre><p>下一步选择网盘类型，如果是 Google drive 选择 16：</p><pre><code>Type of storage to configure.
Choose a number from below, or type in your own value
[snip]
16 / Google Drive
   \ &quot;drive&quot;
[snip]
Storage&gt; 16</code></pre><p>下面的 id 和 secret 都默认回车即可：</p><pre><code>Google Application Client Id - leave blank normally.
client_id&gt;
Google Application Client Secret - leave blank normally.
client_secret&gt;</code></pre><p>下面设置可访问全部网盘文件，选择 1：</p><pre><code>Scope that rclone should use when requesting access from drive.
Choose a number from below, or type in your own value
 1 / Full access all files, excluding Application Data Folder.
   \ &quot;drive&quot;
 2 / Read-only access to file metadata and file contents.
   \ &quot;drive.readonly&quot;
   / Access to files created by rclone only.
 3 | These are visible in the drive website.
   | File authorization is revoked when the user deauthorizes the app.
   \ &quot;drive.file&quot;
   / Allows read and write access to the Application Data folder.
 4 | This is not visible in the drive website.
   \ &quot;drive.appfolder&quot;
   / Allows read-only access to file metadata but
 5 | does not allow any access to read or download file content.
   \ &quot;drive.metadata.readonly&quot;
scope&gt; 1</code></pre><p>下面几步都默认回车即可。</p><p>注意到了 use auto config 的时候要选择 No，因为我们是远程 ssh 访问的服务器：</p><pre><code>Use auto config?
 * Say Y if not sure
 * Say N if you are working on a remote or headless machine or Y didn't work
y) Yes
n) No
y/n&gt; n</code></pre><p>下面会返回一个链接，复制链接到浏览器后，登录 google 账户给 rclone 授权。授权完成后会返回一个字符串码，粘贴回终端。</p><p>后续几步默认回车即可，最后输入 q 退出 config。</p><h3>使用</h3><p>配置完成后我们就可以使用了，下面介绍一些基本语法。下面示例中网盘配置名称为 remote。</p><p>列出网盘的所有文件：</p><pre><code>rclone ls remote:
</code></pre><p>列出一个文件夹内的所有文件：</p><pre><code>rclone ls remote:abc
</code></pre><p>创建一个文件夹：</p><pre><code>rclone mkdir remote:abc
rclone mkdir remote:abc/def
</code></pre><p>删除网盘内一个文件：</p><pre><code>rclone delete remote:abc/123.txt
</code></pre><p>删除一个文件夹：</p><pre><code>rclone rmdir remote:abc
</code></pre><p>复制本地一个文件到网盘：</p><pre><code>rclone copy 123.txt remote:abc
</code></pre><p>更多可用命令可以参考官方文档：<a href="https://rclone.org/docs/#subcommands">https://rclone.org/docs/#subcommands</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2454.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>Ubuntu 18.04 升级 Ubuntu 20.04 记录</title>
<link>https://blog.niekun.net/archives/2451.html</link>
<guid>https://blog.niekun.net/archives/2451.html</guid>
<pubDate>Sat, 12 Mar 2022 15:32:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>昨天决定把服务器的系统从 Ubuntu 18.04 升级到 Ubuntu 20.04，其中经历了不少问题点，下面记录下处理过程。</p><p>首先就是升级当前系统所有包到最新：</p><pre><code>apt update &amp;&amp; apt upgrade -y
apt autoremove &amp;&amp; apt purge
</code></pre><p>然后安装升级需要的管理包，不过一般系统都是自带的：</p><pre><code>apt install update-manager-core
</code></pre><p>然后就可以更新系统了：</p><pre><code>do-release-upgrade
</code></pre><p>标准流程就是以上几步，但是在最后一步的时候问题就开始出现了。</p><!--more--><p>在执行升级命令后出现报警：</p><pre><code>Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</code></pre><p>在查询一些资料后，原来是 ssl certificates 验证问题，系统无法鉴定上面的 https 链接证书是否有效就返回错误了。</p><p>这个问题也是我这个系统的一个遗留问题，每次执行 wget 或 curl 下载东西的时候就会提示证书报错，需要通过附加指令跳过证书验证，但这就会存在安全问题了。</p><p>解决方法就是更新本地证书库后添加 <code>SSL_CERT_DIR</code> 环境变量指向系统证书目录：</p><pre><code>update-ca-certificates --verbose --fresh
export SSL_CERT_DIR=/etc/ssl/certs
</code></pre><p>为了方便以后使用，将环境变量添加到 <code>~/.bashrc</code> 文件中。这样就解决了 https 链接证书验证问题。</p><p>然后先删除之前执行升级命令后错误内容：</p><pre><code>rm /var/lib/ubuntu-release-upgrader/release-upgrade-available
/usr/lib/ubuntu-release-upgrader/release-upgrade-motd
</code></pre><p>之后再次执行升级命令 <code>do-release-upgrade</code>。</p><p>这时候报错信息变化了，这时候提示的是 python3 有问题，原因是我当前系统使用的是自己编译的 python 3.8，路径在 /opt 目录下。当时将系统软链接 <code>/usr/bin/python</code> 和 <code>/usr/bin/python3</code> 都指向了自己安装的 python，需要将他们恢复到指向系统内置的 python 程序。</p><p>下面需要介绍下系统内 python 主程序和软链接的分布：</p><pre><code>python2 主应用程序为 /usr/bin/python2.7
python3 主应用程序为 /usr/bin/python3.6
pip 主程序为 /usr/bin/pip
pip3 主程序为 /usr/bin/pip3</code></pre><p>下面是默认的软链接及指向的应用程序：</p><pre><code>/usr/bin/python  -&gt;  /usr/bin/python2.7
/usr/bin/python2  -&gt;  /usr/bin/python2.7
/usr/bin/python3  -&gt;  /usr/bin/python3.6
/usr/local/bin/pip  -&gt;  /usr/bin/pip
/usr/local/bin/pip3  -&gt;  /usr/bin/pip3</code></pre><p>如果你修改过这些软链接到自己的 python 版本，就需要修改回来：</p><pre><code>ln -sf /usr/bin/python2.7 /usr/bin/python
ln -sf /usr/bin/python2.7 /usr/bin/python2
ln -sf /usr/bin/python3.6 /usr/bin/python3
ln -sf /usr/bin/pip /usr/local/bin/pip
ln -sf /usr/bin/pip3 /usr/local/bin/pip3
ldconfig</code></pre><p>以上问题都处理完后，再次执行升级命令，一切都正常了。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2451.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>解决 wget 下载时 certificates 证书报错问题</title>
<link>https://blog.niekun.net/archives/2448.html</link>
<guid>https://blog.niekun.net/archives/2448.html</guid>
<pubDate>Fri, 11 Mar 2022 16:48:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>我的服务器上在使用 wget 或者 curl 等网络工具时，每次都提示类似下面的报错：</p><pre><code>ERROR: cannot verify github.com's certificate, issued by ‘CN=DigiCert High Assurance TLS Hybrid ECC SHA256 2020 CA1,O=DigiCert\\, Inc.,C=US’:
  Unable to locally verify the issuer's authority.
To connect to github.com insecurely, use `--no-check-certificate'.</code></pre><p>需要通过参数跳过证书检查，但是这样又有了安全风险。</p><p>首先尝试更新本地证书文件：</p><pre><code>update-ca-certificates --verbose --fresh</code></pre><p>发现问题没有解决，原来是系统缺少了一个指向证书路径 <code>/etc/ssl/certs</code> 的环境变量，尝试添加：</p><pre><code>export SSL_CERT_DIR=/etc/ssl/certs</code></pre><p>再次测试 wget 命令，发现问题的确没有了。</p><p>可以将上面的环境变量添加到系统 shell 配置文件中，我这里是 <code>~/.bashrc</code>，添加后刷新一下即可：</p><pre><code>source ~/.bashrc</code></pre><p><strong>在更新 Ubuntu18.04 到 20.04 时，也是这个问题导致的报错。</strong></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2448.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>macOS 中给 finder 添加右键打开 vs code 选项</title>
<link>https://blog.niekun.net/archives/2403.html</link>
<guid>https://blog.niekun.net/archives/2403.html</guid>
<pubDate>Thu, 27 Jan 2022 22:00:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>macOS 中的右键菜单没有像 windows 那样多样的选项，我最常用的是：<strong>用 vs code 打开文件夹</strong>，<strong>新建文本文件</strong>等。</p><p>目前有第三方的软件可以添加这些功能，比如 irightmouse，但基本都是收费软件，下面介绍如何通过系统自带的 automator 来添加我们需要的功能。</p><!--more--><h3>vs code 菜单</h3><p>首先我们创建一个 <code>Open in Visual Studio Code</code> 的 action。</p><p>打开 Automator，点击 file - new 创建一个 quick action：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/514859828.jpg" alt="1.jpg" title="1.jpg"></p><p>首先修改右边的参数，workflow receives current <strong>files or folders</strong> in <strong>finder</strong>，下面的 image 根据个人喜好修改：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/133095543.jpg" alt="2.jpg" title="2.jpg"></p><p>然后左侧搜索 <strong>run shell script</strong> 双击添加到右侧，修改 pass input：<strong>as arguments</strong>，然后脚本内容如下：</p><pre><code>for f in &quot;$@&quot;
do
    open -a 'Visual Studio Code' &quot;$f&quot;
done</code></pre><p><img src="https://blog.niekun.net/usr/uploads/2022/01/110998044.jpg" alt="3.jpg" title="3.jpg"></p><p>保存脚本即可，命名为 <code>Open in Visual Studio Code</code>，需要保存到当前用户目录下的 library/services 目录下(默认就会保存到这个目录)：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3983532568.jpg" alt="11.jpg" title="11.jpg"></p><p>然后在 finder 中测试，选中一个文件夹查看右键菜单，在 quick action 中会出现 Open in Visual Studio Code：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/2001620217.jpg" alt="5.jpg" title="5.jpg"></p><p>点击后即可在 vs code 中打开文件或文件夹。</p><h3>copy path 菜单</h3><p>下面我们用同样的方法做一个复制文件或文件夹路径的 action。</p><p>新建一个 quick action，修改右边的参数，workflow receives current <strong>files or folders</strong> in <strong>finder</strong>。然后添加一个 copy to clipboard 的 variable 即可：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3886391154.jpg" alt="6.jpg" title="6.jpg"></p><p>命名为 <code>Copy Path</code> 并保存即可。</p><p>此时 finder 中 quick action 菜单中就会有了对应的选项：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/2514071669.jpg" alt="7.jpg" title="7.jpg"></p><h3>create new txt file 菜单</h3><p>macOS 中没有右键创建新文件的选项，想要在当前目录中创建一个新文件挺麻烦的，下面我们通过类似的方法来创建一个快捷选项。</p><p>新建一个 quick action，这里 receives 选择 no input：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/3418016774.jpg" alt="8.jpg" title="8.jpg"></p><p>然后搜索并添加一个 Run AppleScript 变量，修改脚本内容如下：</p><pre><code>set file_name to &quot;untitled&quot;
set file_ext to &quot;.txt&quot;
set is_desktop to false

-- get folder path and if we are in desktop (no folder opened)
try
    tell application &quot;Finder&quot;
        set this_folder to (folder of the front Finder window) as alias
    end tell
on error
    -- no open folder windows
    set this_folder to path to desktop folder as alias
    set is_desktop to true
end try

-- get the new file name (do not override an already existing file)
tell application &quot;System Events&quot;
    set file_list to get the name of every disk item of this_folder
end tell
set new_file to file_name &amp; file_ext
set x to 1
repeat
    if new_file is in file_list then
        set new_file to file_name &amp; &quot; &quot; &amp; x &amp; file_ext
        set x to x + 1
    else
        exit repeat
    end if
end repeat

-- create and select the new file
tell application &quot;Finder&quot;

    activate
    set the_file to make new file at folder this_folder with properties {name:new_file}
    if is_desktop is false then
        reveal the_file
    else
        select window of desktop
        set selection to the_file
        delay 0.1
    end if
end tell

-- press enter (rename)
tell application &quot;System Events&quot;
    tell process &quot;Finder&quot;
        keystroke return
    end tell
end tell</code></pre><p>脚本中，定义了新建文件的文件名和扩展名，如果修改其他名称可以自行修改。</p><p>完成后保存即可，名称为 <code>Create New TXT File</code>。</p><p>保存后在 finder 中我们在任意位置右键会发现没有 quick action 选项，这是因为这个 action 定义中并没有选择输入源，因为新建文件和当前的文件并没有什么关系。</p><p>此时需要通过左上角的 finder - services 找到我们刚创建的 action：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/404283572.jpg" alt="9.jpg" title="9.jpg"></p><p>也可以给这个 action 定义快捷键，在 keyboard - shrotcuts - services 中找到这个 action 在后边添加 shortcut 即可：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/61778451.jpg" alt="10.jpg" title="10.jpg"></p><p><strong>注意第一次运行这个 action 会提示需要授权 finder 的几个权限，根据提示打开即可。</strong></p><h3>参考链接</h3><p><a href="https://apple.stackexchange.com/questions/129699/create-a-new-txt-file-in-finder-keyboard-shortcut">Create a new (.txt) File in Finder - Keyboard Shortcut</a><br><a href="https://apple.stackexchange.com/questions/238948/osx-how-to-add-a-right-click-option-to-a-folder-which-opens-the-folder-with-an">OSX: how to add a right click option to a folder which opens the folder with an app like VS Code?</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2403.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>获取 JD cookie 方法</title>
<link>https://blog.niekun.net/archives/2388.html</link>
<guid>https://blog.niekun.net/archives/2388.html</guid>
<pubDate>Sun, 09 Jan 2022 18:53:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在运行自动化脚本的时候需要获取到对应网站的登录 cookie，这里介绍通过 chrome 浏览器获取到需要的信息。</p><p>这里提供的方法仅供用于前端开发测试。</p><!--more--><p>首先登陆移动端网站：<a href="https://m.jd.com">https://m.jd.com</a></p><p>右键点击 inspect 进入开发者界面，然后点击网页右上角的登录键根据提示需要输入账户信息登录。</p><p>登录成功后在开发栏切换到 network 选项，并且在 filter 中输入 <code>log.gif</code> 过滤出需要的信息：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/28325132.jpg" alt="1.jpg" title="1.jpg"></p><p>选中第一个 log 文件，点击 header 栏，在其中找到 cookie 项：<br><img src="https://blog.niekun.net/usr/uploads/2022/01/1901791235.jpg" alt="2.jpg" title="2.jpg"></p><p>复制其中的内容到剪贴板。</p><p>找到开发页面下方的 console 栏，我们通过简单的 js 脚本提取出上面 cookie 的有效内容：</p><pre><code>var c = '这里粘贴复制好的 cookie';
var value = c.match(/pt_pin=.+?;/) + c.match(/pt_key=.+?;/);
copy(value);</code></pre><p>执行完成后此时我们的剪贴板里就已经复制好了 cookie 信息。</p><hr><p>手机端可以通过解包 app 来提取 cookie，具体可以参考我的 js 脚本：<a href="https://github.com/nie11kun/config-rules/blob/master/Shadowrocket/get_jdcookie.js">https://github.com/nie11kun/config-rules/blob/master/Shadowrocket/get_jdcookie.js</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2388.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>升级 Xcode 后 QT 编译报错 No rule to make target 解决方法</title>
<link>https://blog.niekun.net/archives/2375.html</link>
<guid>https://blog.niekun.net/archives/2375.html</guid>
<pubDate>Sun, 19 Dec 2021 13:12:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>最近升级了 macOS Monterey 同时更新了 Xcode 到最新版，编译 QT 项目的时候发现报错了：</p><pre><code>No rule to make target 'xxx', needed by 'xxx'. Stop.</code></pre><p>解决方法就是删除项目<strong>编译输出文件夹</strong>内的隐藏文件 <code>.qmake.stash</code>，删除文件后运行 <strong>build - clean</strong>， <strong>build - run qmake</strong> 重新生成此文件，最后再次重新编译即可。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2375.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
<item>
<title>使用 OpenCore Legacy Patcher 为 2015 款 MacBook Pro 激活 AirPlay</title>
<link>https://blog.niekun.net/archives/2353.html</link>
<guid>https://blog.niekun.net/archives/2353.html</guid>
<pubDate>Fri, 26 Nov 2021 20:31:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[you are the company you keep...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>今年发布的 macOS Monterey 增加了很多新功能，其中一个就是可以通过 AirPlay 将手机屏幕投放到 Mac 上。这个功能挺有意思的，但是当我把我的 MacBook Pro 升级系统后，发现无法使用这个功能，经过查询后发现这些新功能只对较新款的设备开放，这就有点让人吐槽了。<br>但是不放弃的我开始查询是否有大神给不支持的设备添加上这些功能，果然被我找到了，而且是一个挺有名的项目：<strong>OpenCore Legacy Patcher</strong>。</p><!--more--><p><strong>OpenCore Legacy Patcher</strong> 是一个旨在帮助不被苹果官方支持的老版本 Mac 升级到最新系统及特殊功能的项目。为这些老设备提供接近于原生的体验。</p><p>GitHub 地址：<a href="https://github.com/dortania/OpenCore-Legacy-Patcher/">https://github.com/dortania/OpenCore-Legacy-Patcher/</a></p><p>我的是 2015 款 MacBook Pro，系统是支持直接升级到 Monterey 的，就是缺失了一些新功能，也可以使用这个工具来解锁这些限制。</p><h3>下载安装</h3><p>在 release 页面下载最新版，下载 TUI 即可也就是 terminal 版：<br><a href="https://github.com/dortania/OpenCore-Legacy-Patcher/releases">https://github.com/dortania/OpenCore-Legacy-Patcher/releases</a></p><p>下载解压后拖放到 application 文件夹即可完成安装。</p><h3>配置</h3><p>注意在操作前最好做一次 Time Machine 备份系统，以免操作失败后数据丢失。</p><p>打开OpenCore-Patcher 进入配置界面：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/771952879.jpg" alt="1.jpg" title="1.jpg"></p><p>上面提示此设备并不在这个 patcher 列表中，因为它依然可以收到苹果官方的系统支持。但我们依然想利用这个 patcher 来解锁一些功能，所以首先我们需要允许 opencore 运行在此设备上。</p><p>选择 4. patcher settings 回车：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/1199003523.jpg" alt="2.jpg" title="2.jpg"></p><p>选择 8. allow opencore on native models 回车后输入 y 确认，修改后 8 选项变为 currently true：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/4193487915.jpg" alt="3.jpg" title="3.jpg"></p><p>输入 q 返回主菜单，可以看到显示当前设备已被支持：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/3356615953.jpg" alt="4.jpg" title="4.jpg"></p><p>如果你的设备本来就已经进入了 opencore 的支持列表，则不需要进行以上操作。</p><p>下一步设置 opencore 的默认启动模式，默认情况下安装 opencore 后每次启动系统会自动跳入引导选择界面，用来选择正常启动还是通过 pathcer 启动。但是这样比较麻烦，一般情况下配置好后，我们希望自动进入 patcher 后的系统，所以我们将自动跳入引导选择界面功能关闭，这样后续依然可以通过启动时按住 option 键来进入引导选择。</p><p>主界面选择 5. patcher settings，然后选择 5. miscellaneous settings：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/573877562.jpg" alt="5.jpg" title="5.jpg"></p><p>选择 1. set showpicker mode:<br><img src="https://blog.niekun.net/usr/uploads/2021/11/2801299974.jpg" alt="14.jpg" title="14.jpg"></p><p>上面会提示此选项的含义，这里输入 n 关闭此功能：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/818715180.jpg" alt="6.jpg" title="6.jpg"></p><p>输入 q 回到主界面。</p><p>下面我们需要将上面的配置的结果 bulid 到系统临时路径中，选择 1. bulid opencore，完成 build 后输入 enter 返回：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/3345384447.jpg" alt="7.jpg" title="7.jpg"></p><p>最后，就需要将刚才 build 的数据写入到 usb 或内部存储器中。</p><p>如果写入到 usb 中，如果需要系统加载那些隐藏功能，就需要插入写好数据的 usb 然后启动系统时按住 option 选择 opencore 引导系统。如果写入系统内部存储器，就无须外部设备了，可以做到正常启动自动加载 patcher。这里介绍直接安装到设备内部存储器。</p><p>主界面选择 2. install opencore to usb/internal drive:<br><img src="https://blog.niekun.net/usr/uploads/2021/11/1527068884.jpg" alt="8.jpg" title="8.jpg"></p><p>输入 0 选择内部存储器：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/1700583359.jpg" alt="9.jpg" title="9.jpg"></p><p>在此输入 0 选择 EFI 分区：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/3610085083.jpg" alt="10.jpg" title="10.jpg"></p><p>确认后 opencore 就写入系统中。</p><p>等待完成写入后手动重启系统，启动时按住 option 键进入引导选择界面：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/1349064389.jpg" alt="11.jpg" title="11.jpg"></p><p>这里默认是选中系统默认引导的，如果需要后续每次启动都自动进入 opencore boot 引导的话，使用方向键选择到 opencore 图标的 boot 项，然后按住 control 键，此时引导下面会出现一个圆圈，鼠标点击此圆圈代表设置此选项为默认引导项：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/2495783972.jpg" alt="12.jpg" title="12.jpg"></p><p>选择 opencore boot 进入系统后，打开 system preference - sharing：<br><img src="https://blog.niekun.net/usr/uploads/2021/11/4202134834.jpg" alt="15.jpg" title="15.jpg"></p><p>可以看到菜单中多了一个 AirPlay receiver，表明 AirPlay 功能已经成功启动，此时就可以测试手机的 screen mirror 能否监测到 Mac 了。</p><p>后续 OpenCore-Legacy-Patcher 如果有更新了，下载安装最新的 app 后再次通过以上同样的方法来更新补丁即可。</p><h3>查看版本</h3><p>通过命令可以查看当前安装的 opencore 和 opencore legacy patcher 的版本。</p><p>opencore 版本信息：</p><pre><code>% nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:opencore-version

4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:opencore-version    REL-073-2021-09-06</code></pre><p>返回的 <code>REL-073-2021-09-06</code> 表示 opencore 0.7.3 版，编译于 2021.09.06</p><p>opencore legacy patcher 版本信息：</p><pre><code>% nvram 4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:OCLP-Version

4D1FDA02-38C7-4A6A-9CC6-4BCCA8B30102:OCLP-Version    0.3.1%00</code></pre><p>返回值表示当前版本为 0.3.1</p><h3>卸载</h3><p>如果通过 USB 加载 opencore 那么只需要拔出 usb 即可删除 opencore。</p><p>如果安装到内部存储器中，卸载稍微麻烦些，具体参考：<a href="https://dortania.github.io/OpenCore-Legacy-Patcher/UNINSTALL.html">Uninstalling OpenCore</a></p><h3>参考链接</h3><p><a href="https://www.youtube.com/watch?v=sO0yc3_hOE8">Airplay BLOCKED on Monterey? How to unlock it!</a><br><a href="https://dortania.github.io/OpenCore-Legacy-Patcher/">OpenCore Legacy Patcher</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2353.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/</wfw:commentRss>
</item>
</channel>
</rss>