<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
xmlns:atom="http://www.w3.org/2005/Atom"
xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
<title>Marco Nie - macOS</title>
<link>https://blog.niekun.net/category/macos/</link>
<atom:link href="https://blog.niekun.net/feed/category/macos/" rel="self" type="application/rss+xml" />
<language>zh-CN</language>
<description></description>
<lastBuildDate>Sun, 03 Jan 2021 22:40:00 +0800</lastBuildDate>
<pubDate>Sun, 03 Jan 2021 22:40:00 +0800</pubDate>
<item>
<title>修复 parallels desktop 16 网络无法连接问题</title>
<link>https://blog.niekun.net/archives/2040.html</link>
<guid>https://blog.niekun.net/archives/2040.html</guid>
<pubDate>Sun, 03 Jan 2021 22:40:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[随着升级到 macOS Big Sur 后，虚拟机 parallels desktop 也更新到了 16 版本。我当然是继续安装破解版啦。但是安装好后，启动虚拟机会有一个报错：Network I...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>随着升级到 macOS Big Sur 后，虚拟机 parallels desktop 也更新到了 16 版本。我当然是继续安装破解版啦。</p><p>但是安装好后，启动虚拟机会有一个报错：<strong>Network Initialization Failed</strong>，启动后会发现虚拟机无法联网，网络设置中无法正常在各种模式中切换。</p><p>在寻找解决方案期间，了解到了这可能是由于破解的原因，正版用户没有这个问题。网上有人提供了一个方法，执行一条命令就启动虚拟机就可以正常联网了。但是会导致虚拟机无法访问主机的共享目录及无法访问 USB 设备。而且一旦重启 parallels desktop 后又回恢复之前的状态，我也就没有去做。</p><p>这两天看到网上终于有人找到的解决方法，测试后的确可用，所以介绍给大家参考。</p><!--more--><p>解决的方法都是通过修改相关配置文件实现的。首先需要彻底退出 parallels desktop。</p><h3>网络问题</h3><p>修改 <code>/Library/Preferences/Parallels/network.desktop.xml</code> 文件。</p><p>在终端或者 vs code 中打开这个文件，找到 <code>&lt;UseKextless&gt;</code> 标签，将其中的内容改为 0：</p><pre><code>&lt;UseKextless&gt;0&lt;/UseKextless&gt;
</code></pre><p>注意如果你的这个文件内没有这个标签，则需要在 <code>&lt;ParallelsNetworkConfig&gt;</code> 根标签内手动创建它即可。</p><p>修改完成后保存文件，需要输入账户密码。</p><h3>USB 问题</h3><p>修改 <code>/Library/Preferences/Parallels/dispatcher.desktop.xml</code> 文件。</p><p>在终端或者 vs code 中打开这个文件，找到 <code>&lt;Usb&gt;</code> 标签，将其中的内容改为 1：</p><pre><code>&lt;Usb&gt;1&lt;/Usb&gt;
</code></pre><p>修改完成后保存文件，需要输入账户密码。</p><p>修改完以上两个文件后，重启 parallels desktop 就会发现一切都正常了。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/2040.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/2040.html</wfw:commentRss>
</item>
<item>
<title>brew 安装路径</title>
<link>https://blog.niekun.net/archives/1977.html</link>
<guid>https://blog.niekun.net/archives/1977.html</guid>
<pubDate>Wed, 16 Dec 2020 22:04:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[brew 是 macOS 下流行的包管理工具，可以方便的安装各种工具。brew 默认安装路径为：/usr/local/Cellar，然后会在 /usr/local/opt/ 建立所安装的包的软连...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>brew 是 macOS 下流行的包管理工具，可以方便的安装各种工具。</p><p>brew 默认安装路径为：<code>/usr/local/Cellar</code>，然后会在 <code>/usr/local/opt/</code> 建立所安装的包的软连接。</p><p>包安装好后如果不能正常执行，可以建立包的可执行程序的软连接到：<code>/usr/local/bin/</code> 目录。</p><p>比如安装 openssl：</p><pre><code>brew install openssl
</code></pre><p>安装后包的路径为：<code>/usr/local/Cellar/openssl@1.1/1.1.1h</code>。同时包的软连接在：<code>/usr/local/Cellar/openssl</code>。</p><p>这时候执行命令：</p><pre><code>openssl version
</code></pre><p>返回的并不是刚才安装的版本，而是系统自带的老版本的。这时候可以建立可执行程序的软连接到对应路径：</p><pre><code>ln -s /usr/local/opt/openssl/bin/openssl /usr/local/bin/openssl
</code></pre><p>这时候执行命令就可以得到正确的返回：</p><pre><code>openssl version
//OpenSSL 1.1.1h  22 Sep 2020
</code></pre><p>其他包的模式和此类似。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1977.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1977.html</wfw:commentRss>
</item>
<item>
<title>macOS 下使用 QT 部署工具 macdeployqt</title>
<link>https://blog.niekun.net/archives/1966.html</link>
<guid>https://blog.niekun.net/archives/1966.html</guid>
<pubDate>Sat, 05 Dec 2020 23:53:15 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在 Windows 下可以使用 QT 部署工具：windeployqt 来自动提取可执行程序的依赖库，在 macOS 下同样有部署工具：macdeployqt 实现相同的功能。工具路径在 QT ...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在 Windows 下可以使用 QT 部署工具：windeployqt 来自动提取可执行程序的依赖库，在 macOS 下同样有部署工具：macdeployqt 实现相同的功能。</p><p>工具路径在 QT 安装目录的对应编译器 bin 目录下，如：<code>/Users/marconie/Qt/5.15.2/clang_64/bin/macdeployqt</code></p><p>为了方便使用建议将 bin 目录添加到系统 PATH 中，我的终端是 zsh 添加方法如下：</p><p>打开 <code>~/.zshrc</code> 添加如下内容，可以使用 vim 来操作：</p><pre><code>export PATH=$PATH:/Users/marconie/Qt/5.15.2/clang_64/bin</code></pre><p>编辑完成后关闭文件，刷新源：</p><pre><code>source ~/.zshrc
</code></pre><p>现在就可以直接使用命令了：</p><pre><code>macdeployqt -h

</code></pre><!--more--><p>部署的方法是直接在 macdeployqt 后提供 app 路径：</p><pre><code>macdeployqt path/to/test.app
</code></pre><p>执行后会自动搜索此 app 需要的 QT 库并打包到 app 内，可以打开 app 包查看相关内容：<br><img src="https://blog.niekun.net/usr/uploads/2020/12/3770174957.jpg" alt="Screen Shot 2020-12-05 at 23.49.48.jpg" title="Screen Shot 2020-12-05 at 23.49.48.jpg"></p><p>如果项目中使用了其他第三方库，此部署工具不会自动提取相关文件，需要手动将相关库文件添加到 <code>app/Contents/Frameworks</code> 文件夹内。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1966.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1966.html</wfw:commentRss>
</item>
<item>
<title>macOS 下命令行控制显示系统通知</title>
<link>https://blog.niekun.net/archives/1773.html</link>
<guid>https://blog.niekun.net/archives/1773.html</guid>
<pubDate>Sat, 26 Sep 2020 21:42:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在使用 aira2 的 rpc 下载功能时，默认没有下载完成提示，所以需要手动打开 webui 进行查看。关于 aria2 的使用参考我的教程：https://blog.niekun.net/a...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在使用 aira2 的 rpc 下载功能时，默认没有下载完成提示，所以需要手动打开 webui 进行查看。</p><p>关于 aria2 的使用参考我的教程：<a href="https://blog.niekun.net/archives/1199.html">https://blog.niekun.net/archives/1199.html</a></p><p>注意到配置文件里有一个：<code>on-download-complete</code> 选项，可以在下载完成后执行脚本，具体解释参考<a href="https://aria2.github.io/manual/en/html/aria2c.html#cmdoption-on-download-complete">官方网页</a></p><p>可以利用这一点，编写一个脚本来触发系统通知，这样就可以知道文件下载完成了。</p><!--more--><h3>on-download-complete</h3><p>在 aria2 下载完成后，执行 <code>on-download-complete</code> 脚本时会自动传递三个参数：</p><ul><li>GID <em>GID is an ID of a download which aria2c uses to identify a particular download</em></li><li>下载文件个数</li><li>文件路径</li></ul><p>示例：</p><pre><code>$ cat hook.sh
#!/bin/sh
echo &quot;Called with [$1] [$2] [$3]&quot;
$ aria2c --on-download-complete hook.sh http://example.org/file.iso
Called with [1] [1] [/path/to/file.iso]</code></pre><h3>osascript</h3><p>这里使用 AppleScript 来编写简单的系统通知，使用 osascript 可以在 terminal 终端执行 AppleScript 脚本。</p><p>语法结构：</p><pre><code>osascript [-l language] [-i] [-s flags] [-e statement | programfile] [argument ...]
</code></pre><p>这里主要使用 <code>-e</code>选项 来执行 AppleScript 脚本。</p><h4>显示通知</h4><p>显示一个简单的通知很简单：</p><pre><code>osascript -e 'display notification &quot;hello world!&quot;'
</code></pre><p>引号内的就是纯 AppleScript 脚本，很简单。</p><h4>显示带标题的通知</h4><pre><code>osascript -e 'display notification &quot;hello world!&quot; with title &quot;This is the title&quot;'
</code></pre><h4>显示带主副标题的通知</h4><pre><code>osascript -e 'display notification &quot;hello world!&quot; with title &quot;Greeting&quot; subtitle &quot;More text&quot;'
</code></pre><h4>显示带声音提醒的通知</h4><p>系统内置的声音音频在：<code>/System/Library/Sounds</code> 目录：</p><pre><code>$ ls /System/Library/Sounds
Basso.aiff    Frog.aiff    Hero.aiff    Pop.aiff    Submarine.aiff
Blow.aiff    Funk.aiff    Morse.aiff    Purr.aiff    Tink.aiff
Bottle.aiff    Glass.aiff    Ping.aiff    Sosumi.aif</code></pre><p><code>Pop.aiff</code> 这个声音就是默认的提示音。</p><pre><code>osascript -e 'display notification &quot;hello world!&quot; with title &quot;Greeting&quot; subtitle &quot;More text&quot; sound name &quot;Pop.aiff&quot;'
</code></pre><h4>显示需要点击确认的提示框</h4><pre><code>osascript -e 'display alert &quot;Hello World!&quot; message &quot;longer text can be added in the message field.&quot;'
</code></pre><h4>音频提示</h4><p>除了显示系统通知外，也可以用音频提示，使用 <code>say</code> 命令来完成。</p><pre><code>osascript -e 'say &quot;Hello World!&quot;'
</code></pre><p>提示信息将不显示而是语音播报出来。</p><h4>aria2 下载完成提示脚本</h4><p><code>download-complete.sh</code></p><pre><code>#!/bin/sh
osascript -e 'display notification &quot;download complete&quot; sound name &quot;Pop.aiff&quot;'</code></pre><p>参考连接：<br><a href="https://code-maven.com/display-notification-from-the-mac-command-line">https://code-maven.com/display-notification-from-the-mac-command-line</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1773.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1773.html</wfw:commentRss>
</item>
<item>
<title>xattr 命令清除 app 的隔离属性</title>
<link>https://blog.niekun.net/archives/1680.html</link>
<guid>https://blog.niekun.net/archives/1680.html</guid>
<pubDate>Tue, 21 Jul 2020 12:37:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[macOS 中如果安装一些修改版或破解版软件，通过拖拽方式放到 application 目录，在打开 app 的时候可能提示程序无法运行，通常我们在系统 preference - securit...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>macOS 中如果安装一些修改版或破解版软件，通过拖拽方式放到 application 目录，在打开 app 的时候可能提示程序无法运行，通常我们在系统 preference - security 里可以手动允许运行，但是有时候使用这种方法也无法打开，这是由于系统识别到这个 app 可能有问题所以给它加上了 <code>com.apple.quarantine</code> 隔离属性阻止了他的运行。</p><p>如果我们需要运行它，就需要删除 app 的 <code>com.apple.quarantine</code> 属性，可以使用 <code>xattr</code> 来处理。</p><!--more--><p>macOS 上的文件不只有 "normal" 属性，也有 "读", "写", "执行" 等其他属性。常规属性可以用 <code>ls -l myfile</code> 命令来查看。除此之外还可以定义<strong>扩展属性</strong>，扩展属性的修改可以用 <code>xattr</code> 来处理。</p><p>命令语法如下：</p><pre><code>xattr [options] attributes [files]
</code></pre><p>可用 option：</p><pre><code>   -c  CLear all Atrributes.
   -d  Delete the given attribute.
   -h  Help.
   -l  By default, the first two command forms either display just the attribute names or
       values, respectively. The -l option causes both the attribute names and corresponding
       values to be displayed. For hex display of values, the output is preceeded with the hex
       offset values and followed by ASCII display, enclosed by '|'.
   -p  Print the value associated with the given attribute.
   -r  If a file argument is a directory, act as if the entire contents of the directory
       recursively were also specified (so that every file in the directory tree is acted upon).
   -s  If a file argument is a symbolic link, act on the symbolic link itself, rather than
       the file that the symbolic link points at.
   -v  Force the the file name to be displayed, even for a single file.
   -w  Write a given attribute name with a value.
   -x  Force the attribute value to be displayed in the hexadecimal representation.   </code></pre><p>显示一个文件的存在的扩展属性：</p><pre><code>xattr myfile
</code></pre><p>显示一个文件的存在的扩展属性及这个属性的值：</p><pre><code>xattr -l myfile
</code></pre><p>给一个文件添加 <code>com.example.color</code> 属性：</p><pre><code>xattr -w com.example.color myfile
</code></pre><p>清除一个文件的 <code>com.example.color</code> 属性：</p><pre><code>xattr -d com.example.color myfile
</code></pre><p>清除一个文件夹内所有文件的 <code>com.example.color</code> 属性：</p><pre><code>xattr -d -r com.example.color mydir
</code></pre><p>清除一个文件的所有扩展属性：</p><pre><code>xattr -c myfile
</code></pre><hr><p>对于被屏蔽的 app 需要清除<code>com.apple.quarantine</code>  这一属性，处理过程如下：</p><p>首先查看 app 的现有属性：</p><pre><code>xattr /path/to/MyApp.app
</code></pre><p>如果返回的结果有 <code>com.apple.quarantine</code> 属性则执行下面命令删除：</p><pre><code>sudo xattr -r -d com.apple.quarantine /path/to/MyApp.app
</code></pre><p>执行后就可以正常打开 app 了。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1680.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1680.html</wfw:commentRss>
</item>
<item>
<title>MacBook Pro 2015 升级 SSD</title>
<link>https://blog.niekun.net/archives/1640.html</link>
<guid>https://blog.niekun.net/archives/1640.html</guid>
<pubDate>Mon, 13 Jul 2020 14:15:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[最近升级了我的 2015 款 MacBook Pro 13，期间遇到一些问题，这里做一些流水记录：使用 time machine 备份系统拆掉背壳断开电源接口拆掉硬盘螺丝，拿下原装硬盘先在电脑上...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>最近升级了我的 2015 款 MacBook Pro 13，期间遇到一些问题，这里做一些流水记录：</p><ul><li>使用 time machine 备份系统</li><li>拆掉背壳</li><li>断开电源接口</li><li>拆掉硬盘螺丝，拿下原装硬盘</li><li>先在电脑上安装好转接模块</li><li>插上新 SSD，上好螺丝</li><li>接上电源</li><li>按住 cmd option R + 电源键进入恢复系统工具</li><li>连上 WiFi 等待网络下载工具包，大概 2Gb</li><li>进入 disk utility 硬盘工具</li><li>格式化新 SSD，格式 apfs，分区表 guid</li><li>连上 time machine 硬盘，进入恢复工具恢复系统到新 SSD</li></ul><p>关于安装新 SSD 后待机耗电增加参考：<a href="https://blog.niekun.net/archives/1622.html">https://blog.niekun.net/archives/1622.html</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1640.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1640.html</wfw:commentRss>
</item>
<item>
<title>macOS 使用终端命令设置系统代理</title>
<link>https://blog.niekun.net/archives/1629.html</link>
<guid>https://blog.niekun.net/archives/1629.html</guid>
<pubDate>Tue, 07 Jul 2020 23:38:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在平时使用中，我一般是在浏览器内设置代理服务器，还有就是终端设置了代理切换脚本来实现快速切换，系统默认没有代理。关于 macOS/Windows 下设置终端代理可以参考我之前的文章：https:...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在平时使用中，我一般是在浏览器内设置代理服务器，还有就是终端设置了代理切换脚本来实现快速切换，系统默认没有代理。关于 macOS/Windows 下设置终端代理可以参考我之前的文章：<a href="https://blog.niekun.net/archives/97.html">https://blog.niekun.net/archives/97.html</a></p><p>如果想要设置系统级的代理，需要在 system preference - network - proxies 里设置，常用的需要设置 http/https/socks 代理，基本覆盖大多数应用的流量了：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/600970559.png" alt="2020-07-07T14:34:57.png" title="2020-07-07T14:34:57.png"></p><!--more--><p>但是每次需要让其他应用走代理时都要进入系统设置项里打开代理开关很麻烦，可以通过设置 terminal 命令来实现快速切换。</p><h3>networksetup</h3><p>这里需要使用的命令是 <code>networksetup</code>，它可以查看及设置系统网络配置。</p><p>man page：<a href="https://www.unix.com/man-page/osx/8/networksetup/">https://www.unix.com/man-page/osx/8/networksetup/</a></p><p><strong>查看设备可用的网络服务：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -listallnetworkservices
An asterisk (*) denotes that a network service is disabled.
Apple USB Ethernet Hub
iPhone USB
Wi-Fi
Bluetooth PAN
Thunderbolt Bridge</code></pre><p>可以看到设备支持的有线和无线网络服务，<strong>后续设置中需要使用对应的服务名</strong>。</p><p><strong>查看各个网络服务的端口名：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -listallhardwareports

Hardware Port: Wi-Fi
Device: en0
Ethernet Address: a0:99:9b:04:a6:9d

Hardware Port: Bluetooth PAN
Device: en3
Ethernet Address: a0:99:9b:04:a6:9e

Hardware Port: Thunderbolt 1
Device: en1
Ethernet Address: 82:13:07:10:b9:80

Hardware Port: Thunderbolt 2
Device: en2
Ethernet Address: 82:13:07:10:b9:81

Hardware Port: Thunderbolt Bridge
Device: bridge0
Ethernet Address: 82:13:07:10:b9:80

VLAN Configurations
===================</code></pre><p>在后续的设置中会用到 device 名称，可以用以上命令来查询。</p><p><strong>查看某个网络服务的信息：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -getinfo Wi-Fi
DHCP Configuration
IP address: 192.168.123.25
Subnet mask: 255.255.255.0
Router: 192.168.123.1
Client ID: 
IPv6: Automatic
IPv6 IP address: none
IPv6 Router: none
Wi-Fi ID: a0:99:9b:04:a6:9d</code></pre><p><strong>查看系统记录的可连接的无线信号，可以使用命令来查看，需要用到上面得到的 device name：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -listpreferredwirelessnetworks en0
Preferred networks on en0:
    zhang_4lou
    Phicomm_A196D8
    TP-LINK_27BB
    MERCURY_F610
    iPhone (MISS)
    Marco Nie’s 8
    Office_Diagnosis</code></pre><p><strong>查看当前连接的无线接入点名称：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -getairportnetwork en0
Current Wi-Fi Network: My2.4G</code></pre><p><strong>关闭无线连接：</strong></p><pre><code>networksetup -setairportpower en0 off
</code></pre><p><strong>打开无线连接：</strong></p><pre><code>networksetup -setairportpower en0 on
</code></pre><p><strong>查询当前无线连接是否打开状态：</strong></p><pre><code>marconie@marco-mbp ~ % networksetup -getairportpower en0
Wi-Fi Power (en0): On
</code></pre><p><strong>设置系统 http 代理：</strong></p><pre><code>networksetup -setwebproxy networkservices address port
</code></pre><p><strong>设置系统 https 代理：</strong></p><pre><code>networksetup -setsecurewebproxy networkservices address port
</code></pre><p><strong>设置系统 socks 代理：</strong></p><pre><code>networksetup -setsocksfirewallproxy networkservices address port
</code></pre><p>打开/关闭系统代理：</p><pre><code>networksetup [-setwebproxystate | -setsecurewebproxystate | -setsocksfirewallproxystate] networkservices [on | off]
</code></pre><h3>应用</h3><p>上面介绍的常用的 <code>networksetup</code> 命令，下面介绍具体如何设置系统代理。这里以 Wi-Fi 网络服务举例。我的 http 代理地址为：127.0.0.1:1082，socks 代理地址为：127.0.0.1:1080。</p><p>首先设置代理地址：</p><pre><code>networksetup -setwebproxy Wi-Fi 127.0.0.1 1082
networksetup -setsecurewebproxy Wi-Fi 127.0.0.1 1082
networksetup -setsocksfirewallproxy Wi-Fi 127.0.0.1 1080</code></pre><p>以上设置只需要设置一次，以后使用只需要执行打开/关闭代理操作即可。</p><p>打开系统代理：</p><pre><code>networksetup -setwebproxystate Wi-Fi on
networksetup -setsecurewebproxystate Wi-Fi on
networksetup -setsocksfirewallproxystate Wi-Fi on</code></pre><p>关闭系统代理：</p><pre><code>networksetup -setwebproxystate Wi-Fi off
networksetup -setsecurewebproxystate Wi-Fi off
networksetup -setsocksfirewallproxystate Wi-Fi off</code></pre><p>可以在终端执行上述命令，然后打开系统代理设置界面验证是否设置成功。</p><h3>设置 alias 快捷命令</h3><p>如果需要频繁的打开/关闭代理，每次都需要输入以上命令比较麻烦，比较好的方法是设置 alias。关于 alias 我在<a href="https://blog.niekun.net/archives/97.html">macOS/Linux/windows设置终端 proxy 代理</a>里有详细介绍。</p><p>编辑 ~/.bash_frofile 添加如下并保存文件：</p><pre><code>alias pset='networksetup -setwebproxy Wi-Fi 127.0.0.1 1082 &amp;&amp; networksetup -setsecurewebproxy Wi-Fi 127.0.0.1 1082 &amp;&amp; networksetup -setsocksfirewallproxy Wi-Fi 127.0.0.1 1080'
alias psystem='networksetup -setwebproxystate Wi-Fi on &amp;&amp; networksetup -setsecurewebproxystate Wi-Fi on &amp;&amp; networksetup -setsocksfirewallproxystate Wi-Fi on'
alias upsystem='networksetup -setwebproxystate Wi-Fi off &amp;&amp; networksetup -setsecurewebproxystate Wi-Fi off &amp;&amp; networksetup -setsocksfirewallproxystate Wi-Fi off'</code></pre><p>更新缓存，macOS 终端使用的是 zsh，所有要先在 <code>~/.zshrc</code> 里添加一句 <code>source ~/.bash_profile</code>，具体查看我上面提到的文章：</p><pre><code>source ~/.zshrc
</code></pre><p>设置完成后，执行 <code>pset</code> 设置代理地址，执行 <code>psystem</code> 打开系统代理，执行 <code>upsystem</code> 关闭系统代理。</p><h3>参考连接：</h3><p><a href="http://support.moonpoint.com/os/os-x/networksetup-wifi.php">http://support.moonpoint.com/os/os-x/networksetup-wifi.php</a><br><a href="https://superuser.com/questions/316502/how-to-change-proxy-setting-using-command-line-in-mac-os">https://superuser.com/questions/316502/how-to-change-proxy-setting-using-command-line-in-mac-os</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1629.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1629.html</wfw:commentRss>
</item>
<item>
<title>macOS 电源管理修复 MacBook 休眠耗电大问题</title>
<link>https://blog.niekun.net/archives/1622.html</link>
<guid>https://blog.niekun.net/archives/1622.html</guid>
<pubDate>Tue, 07 Jul 2020 10:16:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[20-07-12 update:经过上周几天的观察和这个周末两天休眠的情况，发现一晚上休眠耗电基本2%左右，但是连续休眠两天发现跑了50%电量，今天下午来通过 pmset -g log | gr...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><strong>20-07-12 update:</strong><br>经过上周几天的观察和这个周末两天休眠的情况，发现一晚上休眠耗电基本2%左右，但是连续休眠两天发现跑了50%电量，今天下午来通过 <code>pmset -g log | grep Wake</code> 查看日志，发现一些情况：</p><pre><code>2020-07-10 17:15:08 +0800 Wake Requests           [*process=powerd request=AdaptiveWake deltaSecs=50391 wakeAt=2020-07-11 07:14:59] [process=powerd request=UserWake deltaSecs=150292 wakeAt=2020-07-12 11:00:00 info=&quot;com.apple.alarm.user-visible-com.apple.remindd.time-alarm,315&quot;] 
...
2020-07-12 11:00:02 +0800 Assertions              PID 127(powerd) Created UserIsActive &quot;com.apple.powermanagement.wakeschedule&quot; 00:00:00  id:0x0x900008234 [System: DeclUser IntPrevDisp kDisp]
...</code></pre><p>发现一些和 reminder 和 schedule 有关的唤醒日志。执行 <code>pmset -g sched</code> 的确有很多 remainder 的计划任务：</p><pre><code>marconie@marco-mbp ~ % pmset -g sched
Scheduled power events:
 [0]  wake at 07/13/20 08:01:56 by 'com.apple.alarm.user-visible-Weekly Usage Report'
 [1]  wake at 07/17/20 20:00:00 by 'com.apple.alarm.user-visible-com.apple.remindd.time-alarm' User visible: true
 [2]  wake at 07/19/20 21:00:00 by 'com.apple.alarm.user-visible-com.apple.remindd.time-alarm' User visible: true
 [3]  wake at 07/19/20 21:00:00 by 'com.apple.alarm.user-visible-com.apple.remindd.time-alarm' User visible: true</code></pre><p>这些可能跟我在 remainder 设定的一些事项有关吧，经过查询，网上人也发现这个问题：<a href="https://discussions.apple.com/thread/250736022">eminders app waking mac from sleep</a>，貌似目前没有好的解决方法。</p><!--more--><p>最近升级了我的 macbook pro 2015 的 ssd，买了一块第三方的 nvme 512G 硬盘。更换很顺利，使用 time machine 还原系统后就跟什么都没发生一样。</p><p>但是随着这几天的使用，发现待机耗电巨大，一晚上合盖耗电 20% 左右。查看 activity monitor 也没发现什么耗电量大的后台服务。发现可能是合盖后依然没有进入休眠，一直有什么东西在运转有关。回想我在安装好新硬盘进入系统后，修改了些什么设置，好像就是打开了 find my mac，可能就是休眠后一直存在网络活动有关吧。</p><p>macOS 上可以在设置里对接上电源和使用电池的情况下系统休眠进行单独设置。但是里面的设置项比较少，在使用电池的界面上已经把 休眠后进行网络活动的选项关掉了。</p><p>想要进行更加详细的设置可以使用命令 <code>pmset</code> 处理。<code>pmset</code> 是 macOS 上的电源管理工具，它可以查看，修改系统休眠及唤醒的相关设置。</p><h2>pmset</h2><p><strong>pmset 命令必须在 root 权限下执行。</strong></p><h3>电源管理参数设置</h3><pre><code>sudo pmset [−a | −b | −c | −u] [setting value] [...]
</code></pre><p>pmset 可以对不同电源状态下进行独立设置。</p><ul><li>-a(all, default) 代表对所有供电情况下统一设置，也是默认的选项</li><li>-b(battery) 电池供电情况下的设置参数</li><li>-c(charger) 修改连接上外接电源情况下的设置参数</li><li>-u(UPS) 连接上 ups 情况下的设置参数</li></ul><p>例如，在电池供电情况下，无操作5分钟后屏幕休眠：</p><pre><code>sudo pmset -b displaysleep 5
</code></pre><p>常用的参数有：</p><ul><li>displaysleep – display sleep timer in minutes, 0 to disable display sleep</li><li>disksleep – disk spin-down timer in minutes, 0 to disable disk sleep</li><li>sleep – system sleep timer in minutes, 0 to disable sleep</li><li>hibernatemode - change hibernation mode, 0 for RAM powered while sleeping; 1 for RAM contents written to disk and system totally unpowered; 3 for RAM both powered and written to disk; 5 is the same as mode 1, but for use with secure virtual memory; 7 is the same as mode 3, but for use with secure virtual memory; 25 for hibernation in Mac OS X 10.7, with RAM contents written to disk and system totally unpowered</li><li>autorestart - automatic restart after loss of power, 1 to enable or 0 to disable</li><li>tcpkeepalive - keep network process when sleep, 1 to enable or 0 to disable</li></ul><h3>计划任务的设置</h3><pre><code>sudo pmset [repeat, schedule] [sleep, wake, poweron, shutdown, wakeorpoweron] [&lt;MTWRFSU&gt; &lt;date/time&gt;]
</code></pre><p>pmset 可以设置计划任务，来根据日期来将设备休眠或唤醒。</p><p>例如，每天晚上 23:59 自动关机，每天早上 7:00 自动唤醒或开机：</p><pre><code>sudo pmset repeat shutdown MTWRFSU 23:59:00 wakeorpoweron MTWRFSU 7:00:00
</code></pre><ul><li>type; one of sleep, wake, poweron, shutdown or wakeorpoweron</li><li>date and time (schedule only); in the format "MM/dd/yy HH:mm:ss"; must be in 24-hour format, must be in quotes</li><li>time (repeat only); in the format HH:mm:ss; must be in 24 format, but does not have to be in quotes</li><li>weekdays; a subset of MTWRFSU such as M or MTWRF are valid, as are strings weekdays, weekends, and everyday</li><li>owner; a string describing the person or program who is scheduling the power event (optional)</li></ul><h3>查看电源信息</h3><pre><code>sudo pmset −g [option]
</code></pre><p>当我们想要知道当前系统进行了那些设置，我们可以使用 <code>-g</code> 参数来查看。</p><p>查看当前状况下的电源参数设置：</p><pre><code>sudo pmset -g
</code></pre><p>查看所有电源情况下的参数设置：</p><pre><code>sudo pmset -g custom
</code></pre><p>查看计划任务的设置：</p><pre><code>sudo pmset -g sched
</code></pre><p>查看历史日志：</p><pre><code>sudo pmset -g log
</code></pre><p>日志的查看一般可以配合 grep 来过滤有用的信息，例如想要查看那些进程唤醒了设备可以使用：</p><pre><code>sudo pmset -g log | grep Wake
</code></pre><h3>修复电源问题</h3><p>首先查看我的电池供电情况下的参数设置：</p><pre><code>sudo pmset -g custom
</code></pre><p>在 Battery Power 列表里可以找到 tcpkeepalive 当前的设置为 1。</p><p>根据我的情况，我修改了电池供电情况下的 tcpkeepalive 为 0，问题就解决了：</p><pre><code>sudo pmset -b tcpkeepalive 0
</code></pre><p>执行命令后，会提示关闭这个参数会导致 find my mac 等功能失效。</p><h3>man pmset</h3><pre><code>PMSET(1)                  BSD General Commands Manual                 PMSET(1)

NAME
     pmset -- manipulate power management settings

SYNOPSIS
     pmset [-a | -b | -c | -u] [setting value] [...]
     pmset -u [haltlevel percent] [haltafter minutes] [haltremain minutes]
     pmset -g [option]
     pmset schedule [cancel | cancelall] type date+time [owner]
     pmset repeat cancel
     pmset repeat type weekdays time
     pmset relative [wake | poweron] seconds
     pmset [touch | sleepnow | displaysleepnow | boot]

DESCRIPTION
     pmset manages power management settings such as idle sleep timing, wake
     on administrative access, automatic restart on power loss, etc.

     Note that processes may dynamically override these power management set-
     tings by using I/O Kit power assertions.  Whenever processes override any
     system power settings, pmset will list those processes and their power
     assertions in -g and -g assertions. See caffeinate(8).

SETTING
     pmset can modify the values of any of the power management settings
     defined below. You may specify one or more setting &amp; value pairs on the
     command-line invocation of pmset.  The -a, -b, -c, -u flags determine
     whether the settings apply to battery ( -b ), charger (wall power) ( -c
     ), UPS ( -u ) or all ( -a ).

     Use a minutes argument of 0 to set the idle time to never for sleep
     disksleep and displaysleep

     pmset must be run as root in order to modify any settings.

SETTINGS
     displaysleep - display sleep timer; replaces 'dim' argument in 10.4
     (value in minutes, or 0 to disable)
     disksleep - disk spindown timer; replaces 'spindown' argument in 10.4
     (value in minutes, or 0 to disable)
     sleep - system sleep timer (value in minutes, or 0 to disable)
     womp - wake on ethernet magic packet (value = 0/1). Same as &quot;Wake for
     network access&quot; in the Energy Saver preferences.
     ring - wake on modem ring (value = 0/1)
     powernap - enable/disable Power Nap on supported machines (value = 0/1)
     proximitywake - On supported systems, this option controls system wake
     from sleep based on proximity of devices using same iCloud id. (value =
     0/1)
     autorestart - automatic restart on power loss (value = 0/1)
     lidwake - wake the machine when the laptop lid (or clamshell) is opened
     (value = 0/1)
     acwake - wake the machine when power source (AC/battery) is changed
     (value = 0/1)
     lessbright - slightly turn down display brightness when switching to this
     power source (value = 0/1)
     halfdim - display sleep will use an intermediate half-brightness state
     between full brightness and fully off  (value = 0/1)
     sms - use Sudden Motion Sensor to park disk heads on sudden changes in G
     force (value = 0/1)
     hibernatemode - change hibernation mode. Please use caution. (value =
     integer)
     hibernatefile - change hibernation image file location. Image may only be
     located on the root volume. Please use caution. (value = path)
     ttyskeepawake - prevent idle system sleep when any tty (e.g. remote login
     session) is 'active'. A tty is 'inactive' only when its idle time exceeds
     the system sleep timer. (value = 0/1)
     networkoversleep - this setting affects how OS X networking presents
     shared network services during system sleep. This setting is not used by
     all platforms; changing its value is unsupported.
     destroyfvkeyonstandby - Destroy File Vault Key when going to standby
     mode. By default File vault keys are retained even when system goes to
     standby. If the keys are destroyed, user will be prompted to enter the
     password while coming out of standby mode.(value: 1 - Destroy, 0 -
     Retain)

GETTING
     -g (with no argument) will display the settings currently in use.
     -g live displays the settings currently in use.
     -g custom displays custom settings for all power sources.
     -g cap displays which power management features the machine supports.
     -g sched displays scheduled startup/wake and shutdown/sleep events.
     -g ups displays UPS emergency thresholds.
     -g ps / batt displays status of batteries and UPSs.
     -g pslog displays an ongoing log of power source (battery and UPS) state.
     -g rawlog displays an ongoing log of battery state as read directly from
     battery.
     -g therm shows thermal conditions that affect CPU speed. Not available on
     all platforms.
     -g thermlog shows a log of thermal notifications that affect CPU speed.
     Not available on all platforms.
     -g assertions displays a summary of power assertions. Assertions may pre-
     vent system sleep or display sleep. Available 10.6 and later.
     -g assertionslog shows a log of assertion creations and releases. Avail-
     able 10.6 and later.
     -g sysload displays the &quot;system load advisory&quot; - a summary of system
     activity available from the IOGetSystemLoadAdvisory API. Available 10.6
     and later.
     -g sysloadlog displays an ongoing log of lives changes to the system load
     advisory. Available 10.6 and later.
     -g ac / adapter will display details about an attached AC power adapter.
     Only supported for MacBook and MacBook Pro.
     -g log displays a history of sleeps, wakes, and other power management
     events. This log is for admin &amp; debugging purposes.
     -g uuid displays the currently active sleep/wake UUID; used within OS X
     to correlate sleep/wake activity within one sleep cycle.  history
     -g uuidlog displays the currently active sleep/wake UUID, and prints a
     new UUID as they're set by the system.
     -g history is a debugging tool. Prints a timeline of system sleeplwake
     UUIDs, when enabled with boot-arg io=0x3000000.
     -g historydetailed Prints driver-level timings for a sleep/wake. Pass a
     UUID as an argument.
     -g powerstate [class names] Prints the current power states for I/O Kit
     drivers. Caller may provide one or more I/O Kit class names (separated by
     spaces) as an argument. If no classes are provided, it will print all
     drivers' power states.
     -g powerstatelog [-i interval] [class names] Periodically prints the
     power state residency times for some drivers. Caller may provide one or
     more I/O Kit class names (separated by spaces). If no classes are pro-
     vided, it will log the IOPower plane's root registry entry. Caller may
     specify a polling interval, in seconds with -i &lt;polling interval&gt;; other-
     wise it defaults to 5 seconds.
     -g stats Prints the counts for number sleeps and wakes system has gone
     thru since boot.
     -g systemstate Prints the current power state of the system and available
     capabilites.
     -g everything Prints output from every argument under the GETTING header.
     This is useful for quickly collecting all the output that pmset provides.
     Available in 10.8.

SAFE SLEEP ARGUMENTS
     hibernatemode supports values of 0, 3, or 25. Whether or not a hiberna-
     tion image gets written is also dependent on the values of standby and
     autopoweroff

     For example, on desktops that support standby a hibernation image will be
     written after the specified standbydelay time. To disable hibernation
     images completely, ensure hibernatemode standby and autopoweroff are all
     set to 0.

     hibernatemode = 0 by default on desktops. The system will not back memory
     up to persistent storage. The system must wake from the contents of mem-
     ory; the system will lose context on power loss. This is, historically,
     plain old sleep.

     hibernatemode = 3 by default on portables. The system will store a copy
     of memory to persistent storage (the disk), and will power memory during
     sleep. The system will wake from memory, unless a power loss forces it to
     restore from hibernate image.

     hibernatemode = 25 is only settable via pmset. The system will store a
     copy of memory to persistent storage (the disk), and will remove power to
     memory. The system will restore from disk image. If you want &quot;hiberna-
     tion&quot; - slower sleeps, slower wakes, and better battery life, you should
     use this setting.

     Please note that hibernatefile may only point to a file located on the
     root volume.

STANDBY ARGUMENTS
     standby causes kernel power management to automatically hibernate a
     machine after it has slept for a specified time period. This saves power
     while asleep. This setting defaults to ON for supported hardware. The
     setting standby will be visible in pmset -g if the feature is supported
     on this machine.

     standbydelayhigh and standbydelaylow specify the delay, in seconds,
     before writing the hibernation image to disk and powering off memory for
     Standby.  standbydelayhigh is used when the remaining battery capacity is
     above highstandbythreshold , and standbydelaylow is used when the remain-
     ing battery capacity is below highstandbythreshold.

     highstandbythreshold has a default value of 50 percent.

     autopoweroff is enabled by default on supported platforms as an implemen-
     tation of Lot 6 to the European Energy-related Products Directive. After
     sleeping for &lt;autopoweroffdelay&gt; seconds, the system will write a hiber-
     nation image and go into a lower power chipset sleep. Wakeups from this
     state will take longer than wakeups from regular sleep.

     autopoweroffdelay specifies the delay, in seconds, before entering
     autopoweroff mode.

UPS SPECIFIC ARGUMENTS
     UPS-specific arguments are only valid following the -u option. UPS set-
     tings also have an on/off value. Use a -1 argument instead of percent or
     minutes to turn any of these settings off. If multiple halt conditions
     are specified, the system will halt on the first condition that occurs in
     a low power situation.

     haltlevel - when draining UPS battery, battery level at which to trigger
     an emergency shutdown (value in %)
     haltafter - when draining UPS battery, trigger emergency shutdown after
     this long running on UPS power (value in minutes, or 0 to disable)
     haltremain - when draining UPS battery, trigger emergency shutdown when
     this much time remaining on UPS power is estimated (value in minutes, or
     0 to disable)

     Note: None of these settings are observed on a system with support for an
     internal battery, such as a laptop. UPS emergency shutdown settings are
     for desktop and server only.

SCHEDULED EVENT ARGUMENTS
     pmset allows you to schedule system sleep, shutdown, wakeup and/or power
     on. &quot;schedule&quot; is for setting up one-time power events, and &quot;repeat&quot; is
     for setting up daily/weekly power on and power off events. Note that you
     may only have one pair of repeating events scheduled - a &quot;power on&quot; event
     and a &quot;power off&quot; event. For sleep cycling applications, pmset can sched-
     ule a &quot;relative&quot; wakeup or poweron to occur in seconds from the end of
     system sleep/shutdown, but this event cannot be cancelled and is inher-
     ently imprecise.

     type - one of sleep, wake, poweron, shutdown, wakeorpoweron
     date/time - &quot;MM/dd/yy HH:mm:ss&quot; (in 24 hour format; must be in quotes)
     time - HH:mm:ss
     weekdays - a subset of MTWRFSU (&quot;M&quot; and &quot;MTWRF&quot; are valid strings)
     owner - a string describing the person or program who is scheduling this
     one-time power event (optional)

POWER SOURCE ARGUMENTS
     -g with a 'batt' or 'ps' argument will show the state of all attached
     power sources.

     -g with a 'pslog' or 'rawlog' argument is normally used for debugging,
     such as isolating a problem with an aging battery.

OTHER ARGUMENTS
     boot - tell the kernel that system boot is complete (normally LoginWindow
     does this). May be useful to Darwin users.
     touch - PM re-reads existing settings from disk.
     noidle - pmset prevents idle sleep by creating a PM assertion to prevent
     idle sleep(while running; hit ctrl-c to cancel). This argument is depre-
     cated in favor of caffeinate(8). Please use caffeinate(8) instead.
     sleepnow - causes an immediate system sleep.
     restoredefaults - Restores Energy Saver settings to their default values.
     (Like clicking &quot;Restore Defaults&quot; in Energy Saver GUI).
     displaysleepnow - causes display to go to sleep immediately.
     resetdisplayambientparams - resets the ambient light parameters for cer-
     tain Apple displays.
     dim - deprecated in 10.4 in favor of 'displaysleep'. 'dim' will continue
     to work.
     spindown - deprecated in 10.4 in favor of 'disksleep'. 'spindown' will
     continue to work.

EXAMPLES
     This command sets displaysleep to a 5 minute timer on battery power,
     leaving other settings on battery power and other power sources unper-
     turbed.

     pmset -b displaysleep 5

     Sets displaysleep to 10, disksleep to 10, system sleep to 30, and turns
     on WakeOnMagicPacket for ALL power sources (AC, Battery, and UPS) as
     appropriate

     pmset -a displaysleep 10 disksleep 10 sleep 30 womp 1

     Restores the system's energy settings to their default values.

     For a system with an attached and supported UPS, this instructs the sys-
     tem to perform an emergency shutdown when UPS battery drains to below
     40%.

     pmset -u haltlevel 40

     For a system with an attached and supported UPS, this instructs the sys-
     tem to perform an emergency shutdown when UPS battery drains to below
     25%, or when the UPS estimates it has less than 30 minutes remaining run-
     time. The system shuts down as soon as either of these conditions is met.

     pmset -u haltlevel 25 haltremain 30

     For a system with an attached and supported UPS, this instructs the sys-
     tem to perform an emergency shutdown after 2 minutes of running on UPS
     battery power.

     pmset -u haltafter 2

     Schedules the system to automatically wake from sleep on July 4, 2016, at
     8PM.

     pmset schedule wake &quot;07/04/16 20:00:00&quot;

     Schedules a repeating shutdown to occur each day, Tuesday through Satur-
     day, at 11AM.

     pmset repeat shutdown TWRFS 11:00:00

     Schedules a repeating wake or power on event every tuesday at 12:00 noon,
     and a repeating sleep event every night at 8:00 PM.

     pmset repeat wakeorpoweron T 12:00:00 sleep MTWRFSU 20:00:00

     Prints the power management settings in use by the system.

     pmset -g

     Prints a snapshot of battery/power source state at the moment.

     pmset -g batt

     If your system suddenly sleeps on battery power with 20-50% of capacity
     remaining, leave this command running in a Terminal window. When you see
     the problem and later power and wake the computer, you'll be able to
     detect sudden discontinuities (like a jump from 30% to 0%) indicative of
     an aging battery.

     pmset -g pslog

SEE ALSO
     caffeinate(8)

FILES
     All changes made through pmset are saved in a persistent preferences file
     (per-system, not per-user) at
     /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist

     Scheduled power on/off events are stored separately in
     /Library/Preferences/SystemConfiguration/com.apple.AutoWake.plist

     pmset modifies the same file that System Preferences Energy Saver modi-
     fies.

Darwin                         November 9, 2012                         Darwin</code></pre><h3>参考链接</h3><p><a href="https://en.wikipedia.org/wiki/Pmset">https://en.wikipedia.org/wiki/Pmset</a><br><a href="https://www.dssw.co.uk/reference/pmset.html">https://www.dssw.co.uk/reference/pmset.html</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1622.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1622.html</wfw:commentRss>
</item>
<item>
<title>VMware Workstation 虚拟机导入 VMware Fusion</title>
<link>https://blog.niekun.net/archives/1575.html</link>
<guid>https://blog.niekun.net/archives/1575.html</guid>
<pubDate>Thu, 02 Jul 2020 22:28:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在 Windows 下我一直在使用 vmware workstation pro 虚拟机，最近需要在 mac 上使用 Windows 软件，所以尝试安装虚拟机，vmware 同样有 mac 下的...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/07/2900570012.png" alt="2020-07-03T13:43:03.png" title="2020-07-03T13:43:03.png"><br>在 Windows 下我一直在使用 vmware workstation pro 虚拟机，最近需要在 mac 上使用 Windows 软件，所以尝试安装虚拟机，vmware 同样有 mac 下的产品 vmware fusion，最便捷的方法就是直接导入 workstation 的到 fusion，这样就不需要重新安装系统和软件了。</p><p>官网：<a href="https://www.vmware.com/products/fusion.html">https://www.vmware.com/products/fusion.html</a></p><!--more--><h3>下载</h3><p>首先到官网下载最新版 vmware fusion，目前版本为 11.5：<a href="https://www.vmware.com/products/fusion/fusion-evaluation.html">https://www.vmware.com/products/fusion/fusion-evaluation.html</a></p><h3>安装</h3><p>安装下载的 dmg 文件，安装过程中会要求输入序列号，请自行查找。</p><p>运行 vmware fusion 需要系统 accessibility 的权限，安装完成后请到 <code>system preference - security &amp; privacy</code> 里打开对应权限：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/4104120793.png" alt="2020-07-03T13:35:03.png" title="2020-07-03T13:35:03.png"></p><h3>复制虚拟机</h3><p>把 Windows 下 workstation 的虚拟机文件夹复制到 mac 端，虚拟机文件夹默认在用户目录 document - Virtual Machines 文件夹内，找到需要复制的虚拟机文件夹如：<code>windows 7</code>,然后拷贝到 mac。</p><p>复制到 mac 后给文件夹名添加后缀：<code>.vmwarevm</code>，如：<code>Windows 7.vmwarevm</code>，会自动识别为 fusion 可打开的类型。</p><p>运行 vmware fusion，选择 file - open and run：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/2165730683.png" alt="2020-07-03T13:44:20.png" title="2020-07-03T13:44:20.png"></p><p>在打开的对话框找到重命名后的文件夹，选择 open，会启动虚拟机，如果无法启动提示：<code>Could not open /dev/vmmon: Broken pipe</code>，则是由于 accessibility 权限未打开。请根据上面的方法打开权限，然后重新运行 fusion。</p><p>启动后可以点击上方的设置，进行具体设置：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/514672474.png" alt="2020-07-03T13:49:54.png" title="2020-07-03T13:49:54.png"></p><h3>usb 连接</h3><p>如果无法将 usb 挂在到虚拟机，提示不可识别的设备，则可能是由于没有打开 usb 3.0 兼容。首先关闭虚拟机，打开<code>设置 - usb &amp; Bluetooth - advanced usb options</code>，将下方的 usb capability 切换到 <code>usb 3.1</code>：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/1422211913.png" alt="2020-07-03T13:53:44.png" title="2020-07-03T13:53:44.png"></p><p>重新启动虚拟机测试是否可以正常识别 usb。如果还是无法识别这可能是 windows usb 3.0 驱动没有安装，可以到 intel 官网下载驱动：<a href="https://downloadcenter.intel.com/download/22824/USB-3-0-Driver-Intel-USB-3-0-eXtensible-Host-Controller-Driver-for-Intel-8-9-100-Series-and-C220-C610-Chipset-Family">下载地址</a></p><p>进入虚拟机安装以上驱动，如果安装出错，则可能需要打 KB2533623 系统补丁，可以到微软官网下载补丁：<a href="https://www.microsoft.com/zh-CN/download/details.aspx?id=26767">点我下载</a></p><p>安装好补丁后重启系统，然后安装 usb 驱动，完成后再次将 usb 设备切换到虚拟机测试是否可以正常识别到了：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/3689437433.png" alt="2020-07-03T14:00:01.png" title="2020-07-03T14:00:01.png"></p><p>以上就是 Windows 下 vmware workstation 虚拟机迁移到 mac 下 vmware fusion 的方法。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1575.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1575.html</wfw:commentRss>
</item>
<item>
<title>Mac 的启动组合键</title>
<link>https://blog.niekun.net/archives/1570.html</link>
<guid>https://blog.niekun.net/archives/1570.html</guid>
<pubDate>Mon, 29 Jun 2020 08:35:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[最近更换 MacBook 的 ssd，需要开机进入实用工具格式化硬盘，需要在开机时使用快捷键来进入，所以整理了一下比较全面的开机快捷键组合。要使用这些组合键中的任何一个，请在按下电源按钮以开启 ...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>最近更换 MacBook 的 ssd，需要开机进入实用工具格式化硬盘，需要在开机时使用快捷键来进入，所以整理了一下比较全面的开机快捷键组合。</p><p><strong>要使用这些组合键中的任何一个，请在按下电源按钮以开启 Mac 后或在 Mac 开始重新启动后，立即按住相应按键。请一直按住，直至电脑出现对应的行为。</strong></p><p>Command (⌘)-R：从内建的 macOS 恢复系统启动。或者，您也可以使用 Option-Command-R 或 Shift-Option-Command-R 以通过互联网从 macOS 恢复功能启动。macOS 恢复功能可以安装不同版本的 macOS，具体取决于您在电脑启动时使用的组合键。如果您的 Mac 使用了固件密码，系统将提示您输入这个密码。</p><p>Option (⌥) 或 Alt：启动进入“启动管理器”，您可以从中选取其他可用的启动磁盘或宗卷。如果您的 Mac 使用了固件密码，系统将提示您输入这个密码。</p><p>Option-Command-P-R：重置 NVRAM 或 PRAM。如果您的 Mac 使用了固件密码，电脑会忽略这个组合键或从 macOS 恢复功能启动。 </p><p>Shift (⇧)：以安全模式启动。如果使用了固件密码，这个组合键将被停用。</p><p>D：启动进入“Apple 诊断”实用工具。或者，您也可以使用 Option-D 通过互联网启动进入这个实用工具。如果使用了固件密码，这个组合键将被停用。</p><p>N：从 NetBoot 服务器启动，前提是您的 Mac 支持网络启动宗卷。要使用服务器上默认的引导映像，请按住 Option-N。如果使用了固件密码，这个组合键将被停用。</p><p>Command-S：以单用户模式启动。如果运行的是 macOS Mojave 或更高版本，或者使用了固件密码，这个组合键将被停用。</p><p>T：以目标磁盘模式启动。如果使用了固件密码，这个组合键将被停用。</p><p>Command-V：以详细模式启动。如果使用了固件密码，这个组合键将被停用。</p><p>推出键 (⏏)、F12、鼠标按钮或触控板按钮：推出可移动介质，例如光盘。如果使用了固件密码，这个组合键将被停用。</p><h3>如果组合键不起作用</h3><p>如果某个组合键在启动时不起作用，以下解决方案之一可能会有所帮助：</p><ul><li>确保同时按住组合键中的所有按键，而不是一次只按住一个。</li><li>将 Mac 关机。然后按下电源按钮，以将 Mac 开机。接下来，在 Mac 启动时按住相应按键。</li><li>在按下相应按键之前等待几秒钟，以便让 Mac 在启动时有更多时间来识别键盘。某些键盘上有一个指示灯会在启动时短暂闪烁，表明键盘已被识别并可供使用。</li><li>如果您使用的是无线键盘，请在可能的情况下将这个键盘接入 Mac。或者使用您的内建键盘或有线键盘。如果您使用的是 PC 专用键盘，例如带有 Windows 标志的键盘，请尝试改用 Mac 专用键盘。</li><li>如果您使用“启动转换”从 Microsoft Windows 进行启动，请对“启动磁盘”偏好设置进行相应设置，修改为从 macOS 启动。随后关机或重新启动，然后再试一次。</li><li>请记住，如果您的 Mac 使用了固件密码，则某些组合键将被停用。</li></ul><p>参考链接：<a href="https://support.apple.com/zh-cn/HT201255">https://support.apple.com/zh-cn/HT201255</a></p><p>关于重置 SMC 和 NVRAM 参考官网教程：<br><a href="https://support.apple.com/zh-cn/HT201295">https://support.apple.com/zh-cn/HT201295</a><br><a href="https://support.apple.com/zh-cn/HT204063">https://support.apple.com/zh-cn/HT204063</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1570.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1570.html</wfw:commentRss>
</item>
</channel>
</rss>