<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
xmlns:atom="http://www.w3.org/2005/Atom"
xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
<title>Marco Nie - telegrambot</title>
<link>https://blog.niekun.net/tag/telegrambot/</link>
<atom:link href="https://blog.niekun.net/feed/tag/telegrambot/" rel="self" type="application/rss+xml" />
<language>zh-CN</language>
<description></description>
<lastBuildDate>Wed, 16 Oct 2019 15:56:00 +0800</lastBuildDate>
<pubDate>Wed, 16 Oct 2019 15:56:00 +0800</pubDate>
<item>
<title>使用 telegram bot 做一个 YouTube 下载器</title>
<link>https://blog.niekun.net/archives/428.html</link>
<guid>https://blog.niekun.net/archives/428.html</guid>
<pubDate>Wed, 16 Oct 2019 15:56:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<content:encoded xml:lang="zh-CN"><![CDATA[
<div id="md_content_1" class="md_content" style="min-height: 50px;"><textarea id="append-test" style="display:none;">需要环境：
Linux
python3
python-telegram-bot
youtube-dl


<!--more-->

### python

我是用的是 python3.4，使用系统包管理器安装：
    apt-get install python3.4

如果系统内安装了多个版本的 python，修改 /usr/bin/python 的默认链接，具体修改方法查看此教程：
https://niekun.net/index.php/archives/413.html

###  python-telegram-bot

安装或升级：
     pip install python-telegram-bot --upgrade

### youtube-dl

GitHub：https://github.com/ytdl-org/youtube-dl

安装最新版库：
```
sudo curl -L -k https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl
sudo chmod a+rx /usr/local/bin/youtube-dl
```

如果运行 youtube-dl 报错，可以新建链接到系统程序目录：
    ln -s /usr/local/bin/youtube-dl /usr/bin/youtube-dl

升级 youtube-dl 也可以使用 pip 完成：
    pip install --upgrade youtube-dl

升级后的可执行文件默认在 pip 目录下，如果使用的 python 是自己编译安装的那需要手动去 python 的 bin 目录下找到 youtube-dl 文件创建软连接到 `/usr/local/bin` 目录。

### 可能运行报错问题及解决

#### 执行脚本后，出现类似如下错误：
```
from tornado.httpserver import HTTPServer from tornado.httpserver import HTTPServer 
syntaxError: invalid syntax
```
可能是 tornado 版本过高，需要进行降级：
    pip install tornado==4.5.3

### telegram bot

首先在 telegram 客户端内添加 [BotFather](https://telegram.me/botfather)

**Creating a new bot**
Use the `/newbot` command to create a new bot. The BotFather will ask you for a name and username, then generate an authorization token for your new bot.

The `name` of your bot is displayed in contact details and elsewhere.

The `Username` is a short name, to be used in mentions and telegram.me links. Usernames are 5-32 characters long and are case insensitive, but may only include Latin characters, numbers, and underscores. Your bot's username must end in ‘bot’, e.g. ‘tetris_bot’ or ‘TetrisBot’.

The `token` is a string along the lines of `110201543:AAHdqTcvCH1vGWJxfSeofSAs0K5PALDsaw` that is required to authorize the bot and send requests to the Bot API. Keep your token secure and store it safely, it can be used by anyone to control your bot.

Generating an authorization token
If your existing token is compromised or you lost it for some reason, use the `/token` command to generate a new one.

### 源码地址

https://github.com/nie11kun/telegram-bot-youtube-downloader

### 开机自动运行脚本

**较新的 Linux 发行版可以使用 systemd 来实现自动启动**，参考：https://blog.niekun.net/archives/1334.html

以下方式适合 Ubuntu 14.04 以下。

打开 rc.local
    vim /etc/init.d/rc.local

在最后添加：
    sudo python /your/script/path.py &

最后使用 "&" 符号功能是让脚本在后台运行，如果要停止脚本需要kill 它的 PID。

查看当前脚本的 PID：
    ps -aux |grep "your.py"

然后停止脚本：
    kill %PID

### windows 下可以使用自带的Linux子系统

打开 cmd，输入命令：bash，即可打开Linux系统。

访问Windows路径：`/mnt/your/folder/path`

注意如果文件夹有空格 " " 在命令行中需要在空格前加转义符 "\\"</textarea></div>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/428.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/tag/telegrambot/</wfw:commentRss>
</item>
</channel>
</rss>