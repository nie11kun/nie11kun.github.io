<!DOCTYPE HTML>
<html class="no-js">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>使用 telegram bot 做一个 YouTube 下载器 - Marco Nie</title>

<link rel="stylesheet" href="../../usr/themes/default/normalize.css">
<link rel="stylesheet" href="../../usr/themes/default/grid.css">
<link rel="stylesheet" href="../../usr/themes/default/style.css">
<!--[if lt IE 9]>
    <script src="//cdnjscn.b0.upaiyun.com/libs/html5shiv/r29/html5.min.js"></script>
    <script src="//cdnjscn.b0.upaiyun.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

<meta name="description" content="需要环境：Linuxpython3python-telegram-botyoutube-dl" />
<meta name="keywords" content="telegrambot" />
<meta name="generator" content="Typecho 1.2/18.10.23" />
<meta name="template" content="default" />
<link rel="pingback" href="../action/xmlrpc" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../action/xmlrpc?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../action/xmlrpc?wlw" />
<link rel="alternate" type="application/rss+xml" title="使用 telegram bot 做一个 YouTube 下载器 &raquo; Marco Nie &raquo; RSS 2.0" href="../feed/archives/428.html" />
<link rel="alternate" type="application/rdf+xml" title="使用 telegram bot 做一个 YouTube 下载器 &raquo; Marco Nie &raquo; RSS 1.0" href="../feed/rss/archives/428.html" />
<link rel="alternate" type="application/atom+xml" title="使用 telegram bot 做一个 YouTube 下载器 &raquo; Marco Nie &raquo; ATOM 1.0" href="../feed/atom/archives/428.html" />
<script type="ced4f76b6af9ec6ba7406a3b-text/javascript">
(function () {
    window.TypechoComment = {
        dom : function (id) {
            return document.getElementById(id);
        },
    
        create : function (tag, attr) {
            var el = document.createElement(tag);
        
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
        
            return el;
        },

        reply : function (cid, coid) {
            var comment = this.dom(cid), parent = comment.parentNode,
                response = this.dom('respond-post-428'), input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response : response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];

            if (null == input) {
                input = this.create('input', {
                    'type' : 'hidden',
                    'name' : 'parent',
                    'id'   : 'comment-parent'
                });

                form.appendChild(input);
            }

            input.setAttribute('value', coid);

            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id' : 'comment-form-place-holder'
                });

                response.parentNode.insertBefore(holder, response);
            }

            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';

            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }

            return false;
        },

        cancelReply : function () {
            var response = this.dom('respond-post-428'),
            holder = this.dom('comment-form-place-holder'), input = this.dom('comment-parent');

            if (null != input) {
                input.parentNode.removeChild(input);
            }

            if (null == holder) {
                return true;
            }

            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
</script>
<script type="ced4f76b6af9ec6ba7406a3b-text/javascript">
(function () {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        triggers: ['scroll', 'mousemove', 'keyup', 'touchstart'],
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        triggers: ['onfocus', 'onmousemove', 'onkeyup', 'ontouchstart'],
        load: 'onload'
    }, added = false;

    document[event.add](event.load, function () {
        var r = document.getElementById('respond-post-428'),
            input = document.createElement('input');
        input.type = 'hidden';
        input.name = '_';
        input.value = (function () {
    var _rR6V = //'eN'
'1be'+'83'//'xN'
+/* 'En'//'En' */''+//'YYC'
'YYC'+'0f'//'rG'
+//'xC'
'1d'+'b'//'F'
+'b3'//'0df'
+//'r'
'81'+'2'//'F'
+'0d'//'WAh'
+//'Vu'
'ca5'+//'q'
'q'+//'Mt8'
'a'+'a0'//'b5'
+'7'//'R'
+//'qv'
'885'+'5'//'c'
+//'u1h'
'c5'+//'Im'
'0'+'c'//'Jc6'
, _Ac8bxr = [[5,8],[20,21]];
    
    for (var i = 0; i < _Ac8bxr.length; i ++) {
        _rR6V = _rR6V.substring(0, _Ac8bxr[i][0]) + _rR6V.substring(_Ac8bxr[i][1]);
    }

    return _rR6V;
})();

        if (null != r) {
            var forms = r.getElementsByTagName('form');
            if (forms.length > 0) {
                function append() {
                    if (!added) {
                        forms[0].appendChild(input);
                        added = true;
                    }
                }
            
                for (var i = 0; i < event.triggers.length; i ++) {
                    var trigger = event.triggers[i];
                    document[event.add](trigger, append);
                    window[event.add](trigger, append);
                }
            }
        }
    });
})();
</script></head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<header id="header" class="clearfix">
<div class="container">
<div class="row">
<div class="site-name col-mb-12 col-9">
<a id="logo" href="../../index.html">Marco Nie</a>
<p class="description">I’m dancing at the feet of my lord...</p>
</div>
<div class="site-search col-3 kit-hidden-tb">
<form id="search" method="post" action="../../index.html" role="search">
<label for="s" class="sr-only">搜索关键字</label>
<input type="text" id="s" name="s" class="text" placeholder="输入关键字搜索" />
<button type="submit" class="submit">搜索</button>
</form>
</div>
<div class="col-mb-12">
<nav id="nav-menu" class="clearfix" role="navigation">
<a href="../../index.html">Article</a>
<a href="../start-page.html" title="About me">About me</a>
</nav>
</div>
</div>
</div>
</header>
<div id="body">
<div class="container">
<div class="row">
<div class="col-mb-12 col-8" id="main" role="main">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
<h1 class="post-title" itemprop="name headline"><a itemprop="url" href="428.html">使用 telegram bot 做一个 YouTube 下载器</a></h1>
<ul class="post-meta">
<li itemprop="author" itemscope itemtype="http://schema.org/Person">作者: <a itemprop="name" href="../author/1/index.html" rel="author">admin</a></li>
<li>时间: <time datetime="2019-10-16T15:56:00+08:00" itemprop="datePublished">2019-10-16</time></li>
<li>分类: <a href="../category/Linux/index.html">Linux</a>,<a href="../category/web/index.html">web</a>,<a href="../category/py/index.html">python</a></li>
</ul>
<div class="post-content" itemprop="articleBody">
<p>需要环境：<br>Linux<br>python3<br>python-telegram-bot<br>youtube-dl</p><h1>python</h1><p>我是用的是 python3.4，使用系统包管理器安装：</p><pre><code>apt-get install python3.4
</code></pre><p>如果系统内安装了多个版本的 python，修改 /usr/bin/python 的默认链接，具体修改方法查看此教程：<br><a href="413.html">https://niekun.net/index.php/archives/413.html</a></p><h1>python-telegram-bot</h1><p>安装或升级：</p><pre><code> pip install python-telegram-bot --upgrade
</code></pre><h1>youtube-dl</h1><p>安装最新版库：</p><pre><code>sudo curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl
sudo chmod a+rx /usr/local/bin/youtube-dl</code></pre><p>如果运行 youtube-dl 报错，可以新建链接到系统程序目录：</p><pre><code>ln /usr/local/bin/youtube-dl /usr/bin/youtube-dl
</code></pre><h1>可能运行报错问题及解决</h1><h2>执行脚本后，出现类似如下错误：</h2><pre><code>from tornado.httpserver import HTTPServer from tornado.httpserver import HTTPServer 
syntaxError: invalid syntax</code></pre><p>可能是 tornado 版本过高，需要进行降级：</p><pre><code>pip install tornado==4.5.3
</code></pre><h1>telegram bot</h1><p>首先在 telegram 客户端内添加 <a href="https://telegram.me/botfather">BotFather</a></p><p><strong>Creating a new bot</strong><br>Use the <code>/newbot</code> command to create a new bot. The BotFather will ask you for a name and username, then generate an authorization token for your new bot.</p><p>The <code>name</code> of your bot is displayed in contact details and elsewhere.</p><p>The <code>Username</code> is a short name, to be used in mentions and telegram.me links. Usernames are 5-32 characters long and are case insensitive, but may only include Latin characters, numbers, and underscores. Your bot's username must end in ‘bot’, e.g. ‘tetris_bot’ or ‘TetrisBot’.</p><p>The <code>token</code> is a string along the lines of <code>110201543:AAHdqTcvCH1vGWJxfSeofSAs0K5PALDsaw</code> that is required to authorize the bot and send requests to the Bot API. Keep your token secure and store it safely, it can be used by anyone to control your bot.</p><p>Generating an authorization token<br>If your existing token is compromised or you lost it for some reason, use the <code>/token</code> command to generate a new one.</p><h1>源码地址</h1><p><a href="https://github.com/nie11kun/telegram-bot-youtube-downloader">https://github.com/nie11kun/telegram-bot-youtube-downloader</a></p><h1>开机自动运行脚本</h1><p>打开 rc.local</p><pre><code>vim /etc/init.d/rc.local
</code></pre><p>在最后添加：</p><pre><code>sudo python /your/script/path.py &amp;
</code></pre><p>最后使用 "&" 符号功能是让脚本在后台运行，如果要停止脚本需要kill 它的 PID。</p><p>查看当前脚本的 PID：</p><pre><code>ps -aux |grep &quot;your.py&quot;
</code></pre><p>然后停止脚本：</p><pre><code>kill %PID
</code></pre><h1>文件合并</h1><p>返回的文件如果大于50mb会自动分隔成49mb的文件，可以使用 cat 命令进行合并：</p><pre><code>cat file.mp4* &gt; file.mp4
</code></pre><h2>windows 下可以使用自带的Linux子系统</h2><p>打开 cmd，输入命令：bash，即可打开Linux系统。</p><p>访问Windows路径：<code>/mnt/your/folder/path</code></p><p>注意如果文件夹有空格 " " 在命令行中需要在空格前加转义符 "\"</p> </div>
<p itemprop="keywords" class="tags">标签: <a href="../tag/telegrambot/index.html">telegrambot</a></p>
</article>
<div id="comments">
<div id="respond-post-428" class="respond">
<div class="cancel-comment-reply">
<a id="cancel-comment-reply-link" href="428.html#respond-post-428" rel="nofollow" style="display:none" onclick="if (!window.__cfRLUnblockHandlers) return false; return TypechoComment.cancelReply();" data-cf-modified-ced4f76b6af9ec6ba7406a3b-="">取消回复</a> </div>
<h3 id="response">添加新评论</h3>
<form method="post" action="https://niekun.net/index.php/archives/428.html/comment" id="comment-form" role="form">
<p>
<label for="author" class="required">称呼</label>
<input type="text" name="author" id="author" class="text" value="" required />
</p>
<p>
<label for="mail">Email</label>
<input type="email" name="mail" id="mail" class="text" value="" />
</p>
<p>
<label for="url">网站</label>
<input type="url" name="url" id="url" class="text" placeholder="http://" value="" />
</p>
<p>
<label for="textarea" class="required">内容</label>
<textarea rows="8" cols="50" name="text" id="textarea" class="textarea" required></textarea>
</p>
<p>
<button type="submit" class="submit">提交评论</button>
</p>
</form>
</div>
</div>
<ul class="post-near">
<li>上一篇: <a href="427.html" title="Linux 添加软连接">Linux 添加软连接</a></li>
<li>下一篇: <a href="430.html" title="Linux 后台程序/端口占用查看及关闭">Linux 后台程序/端口占用查看及关闭</a></li>
</ul>
</div>
<div class="col-mb-12 col-offset-1 col-3 kit-hidden-tb" id="secondary" role="complementary">
<section class="widget">
<h3 class="widget-title">最新文章</h3>
<ul class="widget-list">
<li><a href="534.html">cat 命令 in Linux</a></li><li><a href="526.html">Linux kernel 内核相关</a></li><li><a href="525.html">Linux 命令行 换行符</a></li><li><a href="524.html">github page build failed 问题修复</a></li><li><a href="522.html">DoH &amp; DoT 解析</a></li><li><a href="486.html">PhotoShop 将图片转换为无缝的 pattern 图形</a></li><li><a href="484.html">wget 制作网站镜像</a></li><li><a href="482.html">linux 修改 hostname</a></li><li><a href="468.html">go 语言程序的编译</a></li><li><a href="466.html">VPS 自动备份脚本</a></li> </ul>
</section>
<section class="widget">
<h3 class="widget-title">分类</h3>
<ul class="widget-list"><li class="category-level-0 category-parent"><a href="../category/Linux/index.html">Linux</a><ul class="widget-list"><li class="category-level-1 category-child category-level-odd"><a href="../category/ubuntu/index.html">ubuntu</a></li></ul></li><li class="category-level-0 category-parent"><a href="../category/web/index.html">web</a></li><li class="category-level-0 category-parent"><a href="../category/media/index.html">media process</a><ul class="widget-list"><li class="category-level-1 category-child category-level-odd"><a href="../category/ps/index.html">photoshop</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/fxp/index.html">final cut pro</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/lr/index.html">lightroom</a></li></ul></li><li class="category-level-0 category-parent"><a href="../category/Windows/index.html">Windows</a></li><li class="category-level-0 category-parent"><a href="../category/macos/index.html">macOS</a></li><li class="category-level-0 category-parent"><a href="../category/hardware/index.html">hardware</a></li><li class="category-level-0 category-parent"><a href="../category/essay/index.html">essay</a></li><li class="category-level-0 category-parent"><a href="../category/other/index.html">other</a></li><li class="category-level-0 category-parent"><a href="../category/dev/index.html">Program</a><ul class="widget-list"><li class="category-level-1 category-child category-level-odd"><a href="../category/cpp/index.html">c++</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/py/index.html">python</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/go/index.html">go</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/siemens/index.html">siemens</a></li></ul></li><li class="category-level-0 category-parent"><a href="../category/software/index.html">software</a></li></ul> </section>
<section class="widget">
<h3 class="widget-title">归档</h3>
<ul class="widget-list">
<li><a href="../2019/11/index.html">November 2019</a></li><li><a href="../2019/10/index.html">October 2019</a></li><li><a href="../2019/09/index.html">September 2019</a></li><li><a href="../2019/08/index.html">August 2019</a></li><li><a href="../2019/07/index.html">July 2019</a></li><li><a href="../2019/04/index.html">April 2019</a></li><li><a href="../2019/03/index.html">March 2019</a></li><li><a href="../2019/02/index.html">February 2019</a></li> </ul>
</section>
</div>
</div>
</div>
</div>
<footer id="footer" role="contentinfo">
&copy; 2019 <a href="../../index.html">Marco Nie</a>. All rights reserved.
</footer>
<script src="https://ajax.cloudflare.com/cdn-cgi/scripts/95c75768/cloudflare-static/rocket-loader.min.js" data-cf-settings="ced4f76b6af9ec6ba7406a3b-|49" defer=""></script></body>
</html>
